require=function t(e,n,o){function i(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return i(n?n:t)},u,u.exports,t,e,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({AddDirectionTrigger:[function(t,e,n){"use strict";cc._RFpush(e,"7a28122jWJO3KYCtZuYs/8g","AddDirectionTrigger"),function(){var e,n;e=t("sgr").Directions,n={},n[cc.KEY.up]=[e.Up,!0],n[cc.KEY.down]=[e.Down,!0],n[cc.KEY.left]=[e.Left,!0],n[cc.KEY.right]=[e.Right,!0],n[cc.KEY.w]=[e.Up,!1],n[cc.KEY.s]=[e.Down,!1],n[cc.KEY.a]=[e.Left,!1],n[cc.KEY.d]=[e.Right,!1],this.AddDirectionTrigger=function(t){return cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,o){var i;if(i=n[e],null!=i)return null!=t&&"function"==typeof t.onDirectionTrigger?t.onDirectionTrigger(i[0],i[1]):void 0}},t.node)}}.call(this),cc._RFpop()},{sgr:"sgr"}],Bomb:[function(t,e,n){"use strict";cc._RFpush(e,"6da41Prla9FxqSIloP5yLyn","Bomb"),function(){cc.Class({"extends":cc.Component,initBomb:function(t){var e,n,o;return this.bomb=t,e=new cc.Node,e.parent=this.node,n=e.addComponent(cc.Sprite),o=cc.url.raw("resources/effect/bomb.png"),n.spriteFrame=new cc.SpriteFrame(o),this.updatePosition(),this.bomb.on("OnBombExplosion",this)},update:function(t){return this.updatePosition()},updatePosition:function(){if(null!=this.bomb)return this.node.setPosition(this.bomb.gameObject.position.x,this.bomb.gameObject.position.y)},OnBombExplosion:function(t){if(t===this.bomb)return this.bomb.off("OnBombExplosion",this),this.node.destroy()},showBombExplosion:function(){var t,e,n;return t=new cc.Node(""),t.zIndex=-1,t.setPosition(this.node.convertToWorldSpace(cc.p(0,0))),t.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.5),cc.callFunc(t.removeFromParent,t))),this.bomb.range>0&&(t.scale=this.bomb.range/100),cc.game.addPersistRootNode(t),e=t.addComponent(cc.Sprite),n=cc.url.raw("resources/effect/boom.png"),e.spriteFrame=new cc.SpriteFrame(n)}})}.call(this),cc._RFpop()},{}],Bullet:[function(t,e,n){"use strict";cc._RFpush(e,"da7a2XfgfZC3ruCpQbfE2hU","Bullet"),function(){cc.Class({"extends":cc.Component,initBullet:function(t){var e,n,o;return this.bullet=t,e=new cc.Node,e.parent=this.node,n=e.addComponent(cc.Sprite),o=cc.url.raw("resources/effect/bullet.png"),n.spriteFrame=new cc.SpriteFrame(o),this.updatePosition(),this.bullet.on("OnBulletFinish",this)},update:function(t){return this.updatePosition()},updatePosition:function(){if(null!=this.bullet)return this.node.setPosition(this.bullet.gameObject.position.x,this.bullet.gameObject.position.y)},OnBulletFinish:function(t){if(t===this.bullet)return this.bullet.off("OnBulletFinish",this),this.node.destroy()}})}.call(this),cc._RFpop()},{}],Collection:[function(t,e,n){"use strict";cc._RFpush(e,"91fd1zy991OAaD6RU9WVTtJ","Collection"),function(){var e,n;e=t("sgr").Config,n=[1,2,3,4,5,6,7,200,201],cc.Class({"extends":cc.Component,properties:{nodeFace:cc.Node,nodeFaceList:[cc.Node],container:cc.Layout,labName:cc.Label,labDetail:cc.Label},onLoad:function(){var t,o,i,r;for(this.labName.string="",this.labDetail.string="",r=[],o=0,i=n.length;o<i;o++)t=n[o],r.push(function(t){return function(n){var o,i,r;return i=e.heroDic.find(n),o=cc.instantiate(t.nodeFace),o.parent=t.container.node,t.nodeFaceList.push(o),r=o.getComponent(cc.Sprite),r.spriteFrame=null,cc.loader.loadRes("face/"+i.face,cc.SpriteFrame,function(t,e){return t?console.log(t):r.spriteFrame=e})}}(this)(t));return r},onHeaderClick:function(t){var o,i,r,a,s,c,l;for(c=this.nodeFaceList,l=[],i=r=0,a=c.length;r<a;i=++r)s=c[i],t.target===s&&(o=e.heroDic.find(n[i]),this.labName.string=o.name,l.push(this.labDetail.string=o.detail));return l},onBackClick:function(){return cc.director.loadScene("Logo")}})}.call(this),cc._RFpop()},{sgr:"sgr"}],CommandPlayStageTest:[function(t,e,n){"use strict";cc._RFpush(e,"1fe20cuj3pKSrI8WjAEBFzi","CommandPlayStageTest"),function(){var e,n,o;o=t("sgr"),e=o.CommandPlayStage,n=o.TeamCamp,cc.Class({"extends":cc.Component,onLoad:function(){var t;return this.stage=new e,t=this.node.getComponent("StageEventHandle"),t.setStage(this.stage),this.stage.createPlayerTeam(["1","2","3","4","5","6","7"],n.Blue),cc.director.getScheduler().schedule(this.onTime,this,.5)},onTime:function(t){return this.stage.addCommand(t)},update:function(t){return this.stage.update(t)}})}.call(this),cc._RFpop()},{sgr:"sgr"}],DropItemCoin:[function(t,e,n){"use strict";cc._RFpush(e,"9fb6aP3ZZdJ77b19MpQwXks","DropItemCoin"),function(){cc.Class({"extends":cc.Component,init:function(t){return this.coinItem=t,cc.loader.loadRes("effect/coin",cc.SpriteFrame,function(t){return function(e,n){var o;return o=new cc.Node,o.parent=t.node,o.addComponent(cc.Sprite).spriteFrame=n}}(this)),null!=this.coinItem&&this.node.setPosition(this.coinItem.gameObject.position.x,this.coinItem.gameObject.position.y),this.coinItem.on("OnDropItemCoinGet",this)},OnDropItemCoinGet:function(t){if(t===this.coinItem)return this.coinItem.off("OnDropItemCoinGet",this),this.node.destroy()}})}.call(this),cc._RFpop()},{}],DropItemHero:[function(t,e,n){"use strict";cc._RFpush(e,"cafb5okQt1OsIaEHMuxVWzW","DropItemHero"),function(){cc.Class({"extends":cc.Component,init:function(t){return this.heroItem=t,cc.loader.loadRes("effect/hero-item",cc.SpriteFrame,function(t){return function(e,n){var o;return o=new cc.Node,o.parent=t.node,o.addComponent(cc.Sprite).spriteFrame=n}}(this)),null!=this.heroItem&&this.node.setPosition(this.heroItem.gameObject.position.x,this.heroItem.gameObject.position.y),this.heroItem.on("OnDropItemHeroGet",this)},OnDropItemHeroGet:function(t){if(t===this.heroItem)return this.heroItem.off("OnDropItemHeroGet",this),this.node.destroy()}})}.call(this),cc._RFpop()},{}],FormationChange:[function(t,e,n){"use strict";cc._RFpush(e,"3f937/hggdIbb5MEo0tioOv","FormationChange"),function(){var e,n,o;n=t("Global"),e=t("sgr").Config,o=[1,2,3,4,5,6,7,200,201],cc.Class({"extends":cc.Component,properties:{nodeFace:cc.Node,nodeCurHeroList:[cc.Node],nodeIdleHeroList:[cc.Node],curHeroContainer:cc.Layout,idleHeroContainer:cc.Layout,curHeroIdList:[cc.Integer],curSelectFace:cc.Node},onLoad:function(){return this.updateFormation([])},onEnable:function(){var t;return null!=(t=n.GetClient())&&t.send(new client.GetFormationReq),n.GetClient().handle.onGetFormationRsp(this,this.onGetFormationRsp)},onDisable:function(){if(null!=n.GetClient())return n.GetClient().handle.offGetFormationRsp(this,this.onGetFormationRsp)},updateFormation:function(t){var e,n,i,r,a,s,c,l;for(this.curHeroIdList=t,this.curHeroIdList=_.sortBy(this.curHeroIdList),this.curHeroContainer.node.removeAllChildren(),this.idleHeroContainer.node.removeAllChildren(),s=this.curHeroIdList,n=0,r=s.length;n<r;n++)e=s[n],this.nodeCurHeroList.push(this.createFaceToContainer(e,this.curHeroContainer));for(c=_.difference(o,this.curHeroIdList),l=[],i=0,a=c.length;i<a;i++)e=c[i],l.push(this.nodeCurHeroList.push(this.createFaceToContainer(e,this.idleHeroContainer)));return l},createFaceToContainer:function(t,n){var o,i,r;return i=e.heroDic.find(t),o=cc.instantiate(this.nodeFace),o.tag=t,o.parent=n.node,r=o.getComponent(cc.Sprite),r.spriteFrame=null,cc.loader.loadRes("face/"+i.face,cc.SpriteFrame,function(t,e){return t?console.log(t):r.spriteFrame=e}),o},getNewFormation:function(t,e){var n;return n=_.without(this.curHeroIdList,t),n.push(e),n},onFaceClick:function(t){var e;return null===this.curSelectFace?(this.curSelectFace=t.target,this.curSelectFace.scale=1.2):(this.curSelectFace.parent!==t.target.parent&&(e=this.curSelectFace.parent===this.curHeroContainer.node?this.getNewFormation(this.curSelectFace.tag,t.target.tag):this.getNewFormation(t.target.tag,this.curSelectFace.tag),this.updateFormation(e)),this.curSelectFace.scale=1,this.curSelectFace=null)},onBackClick:function(){var t;return t=new client.SetFormationReq,t.formation=this.curHeroIdList,n.GetClient().send(t),cc.director.loadScene("Main")},onGetFormationRsp:function(t){return this.updateFormation(t.formation)}})}.call(this),cc._RFpop()},{Global:"Global",sgr:"sgr"}],Global:[function(t,e,n){"use strict";function o(t,e){return c=new client.Client,c.bindHandle(new WebSocket(t)),c.ws.onopen=function(){var t;return t=new client.LoginReq,t.account=e,c.send(t)},c.ws.onerror=function(t){return console.log(t)},c.ws.onclose=function(){return cc.director.loadScene("Logo"),c=null},c}function i(){return c}function r(t){return cc.loader.loadRes("prefab/ToolTips",function(e,n){var o,i;return o=cc.instantiate(n),cc.director.getScene().addChild(o),i=o.getComponent("ToolTips"),i.setContent(t),i.scheduleOnce(function(){return o.removeFromParent()},2)})}function a(t,e){var n,o,i,r,a;for(t=["1","2","3","4","5","100","101","102","103","104","105","106","107","108","200","201"],r=0,a=[],o=0,i=t.length;o<i;o++)n=t[o],a.push(cc.loader.loadRes("unit/"+s.Config.heroDic.find(n).image,cc.SpriteAtlas,function(n,o){if(++r>=t.length)return e()}));return a}cc._RFpush(e,"7c5756PhXhCDqI/TcIsLi+s","Global");var s=t("sgr"),c=null;n.CreateClient=o,n.GetClient=i,n.IsGMEnabled=!0,n.ShowToolTips=r,n.SuccessNotice=null,n.PreloadSuccessNotice=a,cc._RFpop()},{sgr:"sgr"}],HeroTest:[function(t,e,n){"use strict";cc._RFpush(e,"d03c3KiuzZJiaiB3vAwV0Dr","HeroTest"),function(){var e;e=t("sgr").Directions,cc.Class({"extends":cc.Component,properties:{hero:cc.Component,heroPrefab:cc.Prefab},registKeyboard:function(){var t;return t={},this.keyboardListen=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e){return function(n,o){var i;return null!=(i=t[n])?i.call(e):void 0}}(this)}),cc.eventManager.addListener(this.keyboardListen,1),t[cc.KEY.up]=function(){return this.hero.playMove(e.Up)},t[cc.KEY.down]=function(){return this.hero.playMove(e.Down)},t[cc.KEY.left]=function(){return this.hero.playMove(e.Left)},t[cc.KEY.right]=function(){return this.hero.playMove(e.Right)},t[cc.KEY.space]=function(){return this.hero.setHpColor(Math.random()>.5?cc.Color.GREEN:cc.Color.RED),this.hero.showHp(Math.random()),cc.loader.loadRes("audio/effect/hero",function(t,e){return cc.audioEngine.playEffect(e,!1)})},t[cc.KEY[1]]=function(){return this.hero.showCycle(200)},t[cc.KEY[2]]=function(){return this.hero.showHalfCycle(200)},t[cc.KEY[3]]=function(){return this.hero.showSnipeSight()},t[cc.KEY[4]]=function(){return this.hero.showRectangle(200,50)}},onLoad:function(){var t;return this.registKeyboard(),t=cc.instantiate(this.heroPrefab),t.parent=this.node,t.setPosition(0,0),this.hero=t.getComponent("Hero"),this.hero.setAtlasName("Unit_mov_139-1"),this.hero.playMove(),this.hero.hideHp(),this.hero.setHpParentNode(this.node)},update:function(t){}})}.call(this),cc._RFpop()},{sgr:"sgr"}],Hero:[function(t,e,n){"use strict";cc._RFpush(e,"1fee0Y9jCxJa7RWZiOnA0rm","Hero");var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},r=t("sgr"),a=["OnTeamRemoveMember","OnHeroChangeDirection","OnHeroHurt","OnHeroHeal","OnCycleAOECreate","OnHalfCycleAOECreate","OnRectangleAOECreate","OnSnipeBegin","OnSkillCooldownChangeAdd","OnSkillCooldownChangeRemove"],s=3,c={};c[r.Directions.Right]=0,c[r.Directions.Down]=90,c[r.Directions.Left]=180,c[r.Directions.Up]=270;var l=function(t){function e(){var e=t.apply(this,arguments)||this;return e.atlasName="",e}return o(e,t),e.prototype.init=function(t){var e,n,o,i;for(this.hero=t,this.setAtlasName(r.Config.heroDic.find(this.hero.id).image),this.playMove(this.hero.direction),this.updatePosition(),i=[],n=0,o=a.length;n<o;n++)e=a[n],i.push(this.hero.on(e,this));return i},e.prototype.setAtlasName=function(t){return this.atlasName=t,cc.loader.loadRes("unit/"+this.atlasName,cc.SpriteAtlas,function(t){return function(e,n){return t.atlas=n,e?console.log(e):t.setSpriteIndex(0)}}(this))},e.prototype.getSpriteFrameName=function(t){return this.atlasName+"_"+t},e.prototype.setHpParentNode=function(t){var e;if(null!=t)return e=this.sprHpBarBg.getPosition(),this.sprHpBarBg.removeFromParent(),t.addChild(this.sprHpBarBg),this.schedule(function(n){return function(){var o;return o=t.convertToNodeSpace(n.node.convertToWorldSpace(cc.v2())),n.sprHpBarBg.setPosition(o.add(e))}}(this),0)},e.prototype.onDestroy=function(){var t,e,n,o;for(this.sprHpBarBg.removeFromParent(),o=[],e=0,n=a.length;e<n;e++)t=a[e],o.push(this.hero.off(t,this));return o},e.prototype.OnTeamRemoveMember=function(t){if(this.hero===t)return this.node.destroy()},e.prototype.OnHeroChangeDirection=function(t){if(this.hero===t)return this.playMove(t.direction),this.directionNode.rotation=c[t.direction]},e.prototype.OnHeroHurt=function(t,e){if(this.hero===t&&0!==t.maxHp)return this.showHp(t.hp/t.maxHp)},e.prototype.OnHeroHeal=function(t,e){if(this.hero===t&&0!==t.maxHp)return this.showHp(t.hp/t.maxHp)},e.prototype.OnCycleAOECreate=function(t){if(this.hero.gameObject===t.gameObject)return this.showCycle(t.range)},e.prototype.OnHalfCycleAOECreate=function(t){if(this.hero.gameObject===t.gameObject)return this.showHalfCycle(t.range)},e.prototype.OnRectangleAOECreate=function(t){if(this.hero.gameObject===t.gameObject)return this.showRectangle(t.range,t.width)},e.prototype.OnSnipeBegin=function(t,e){if(this.hero===e)return this.showSnipeSight()},e.prototype.OnSkillCooldownChangeAdd=function(t){if(this.hero===t)return this.spriteScaleNode.scale=1.5},e.prototype.OnSkillCooldownChangeRemove=function(t){if(this.hero===t)return this.spriteScaleNode.scale=1},e.prototype.update=function(t){this.updatePosition(),this.updateAnime(t),this.updateShowHpCooldown(t)},e.prototype.updatePosition=function(){if(null!=this.hero)return this.node.setPosition(this.hero.gameObject.position.x,this.hero.gameObject.position.y)},e.prototype.setHpProgress=function(t){return this.barHp.progress=t},e.prototype.setHpColor=function(t){return this.sprHpBar.color=this.sprHpBarBg.color=t},e.prototype.showHp=function(t){return this.setHpProgress(t),this.barHp.node.active=!0,this.hpShowCooldown=s},e.prototype.hideHp=function(){return this.barHp.node.active=!1,this.hpShowCooldown=0},e.prototype.playEffect=function(t){return cc.loader.loadRes("audio/effect/"+t,function(t,e){return cc.audioEngine.playEffect(e,!1)})},e.prototype.updateShowHpCooldown=function(t){if(this.hpShowCooldown>0&&(this.hpShowCooldown-=t,this.hpShowCooldown<=0))return this.barHp.node.active=!1},e.prototype.createChildSprite=function(t,e){void 0===e&&(e=0);var n=new cc.Node("");n.zIndex=e;var o=n.addComponent(cc.Sprite);n.parent=this.node;var i=cc.url.raw("resources/effect/"+t+".png");return o.spriteFrame=new cc.SpriteFrame(i),n},e.prototype.showCycle=function(t){var e;return e=this.createChildSprite("cycle",-1),e.opacity=0,e.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.5),cc.callFunc(e.removeFromParent,e))),e.scale=t/100,this.playEffect("aoe")},e.prototype.showHalfCycle=function(t){var e=new cc.Node("");e.zIndex=-1;var n=e.addComponent(cc.Sprite);e.parent=this.directionNode;var o=cc.url.raw("resources/effect/half-cycle.png");return n.spriteFrame=new cc.SpriteFrame(o),e.setAnchorPoint(0,.5),e.opacity=0,e.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.5),cc.callFunc(e.removeFromParent,e))),e.scale=t/100,this.playEffect("aoe")},e.prototype.showRectangle=function(t,e){var n=new cc.Node("");n.zIndex=-1;var o=n.addComponent(cc.Sprite);n.parent=this.directionNode;var i=cc.url.raw("resources/effect/rectangle.png");return o.spriteFrame=new cc.SpriteFrame(i),n.setAnchorPoint(0,.5),n.opacity=0,n.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.5),cc.callFunc(n.removeFromParent,n))),n.scaleX=t/100,n.scaleY=2*e/100,this.playEffect("aoe")},e.prototype.showSnipeSight=function(){var t=this.createChildSprite("snipe");return t.opacity=0,t.runAction(cc.sequence(cc.fadeIn(.5),cc.fadeOut(.2),cc.callFunc(t.removeFromParent,t)))},e.prototype.setFrameSize=function(t){this.frameSize=t},e.prototype.play=function(t,e){void 0===e&&(e=!0);var n;if(this.frames=t,this.isLoop=e,this.curIndex=0,this.curDelay=this.delay,(null!=(n=this.frames)?n.length:void 0)>0)return this.setSpriteIndex(this.frames[0])},e.prototype.flipSprite=function(t){return this.sprite.node.setScaleX(t?-1:1)},e.prototype.playMove=function(t){return null==t&&(t=r.Directions.Up),t===r.Directions.Down?this.play([0,1]):t===r.Directions.Up?this.play([2,3]):t===r.Directions.Left?(this.play([4,5]),this.flipSprite(!1)):t===r.Directions.Right?(this.play([4,5]),this.flipSprite(!0)):void 0},e.prototype.playAttack=function(t){return null==t&&(t=r.Directions.Up),t===r.Directions.Down?this.play([0,1,2,3]):t===r.Directions.Up?this.play([4,5,6,7]):t===r.Directions.Left?(this.play([8,9,10,11]),this.flipSprite(!1)):t===r.Directions.Right?(this.play([8,9,10,11]),this.flipSprite(!0)):void 0},e.prototype.setSpriteIndex=function(t){if(null!=this.atlas)return this.sprite.spriteFrame=this.atlas.getSpriteFrame(this.getSpriteFrameName(t))},e.prototype.setNextSpriteIndex=function(){return this.curIndex=this.curIndex+1<this.frames.length?this.curIndex+1:0,this.setSpriteIndex(this.frames[this.curIndex])},e.prototype.isLastSprite=function(){return!(this.curIndex<this.frames.length)},e.prototype.updateAnime=function(t){if((this.isLoop||!this.isLastSprite())&&(this.curDelay-=t,this.curDelay<=0))return this.curDelay=this.delay,this.setNextSpriteIndex()},e}(cc.Component);i([cc.Property(cc.Sprite)],l.prototype,"sprite",void 0),i([cc.Property(cc.Node)],l.prototype,"spriteScaleNode",void 0),i([cc.Property(cc.Node)],l.prototype,"directionNode",void 0),i([cc.Property(cc.ProgressBar)],l.prototype,"barHp",void 0),i([cc.Property(cc.Node)],l.prototype,"sprHpBar",void 0),i([cc.Property(cc.Node)],l.prototype,"sprHpBarBg",void 0),i([cc.Property(.2)],l.prototype,"delay",void 0),i([cc.Property([cc.Integer])],l.prototype,"frames",void 0),i([cc.Property(48)],l.prototype,"frameSize",void 0),i([cc.Property(0)],l.prototype,"curIndex",void 0),i([cc.Property(0)],l.prototype,"hpShowCooldown",void 0),l=i([cc.RegisterComponent],l),cc._RFpop()},{sgr:"sgr"}],KeyPressHandler:[function(t,e,n){"use strict";function o(t,e){null!=t&&cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(t,n){for(var o in e){var i=e[o];cc.KEY[o]===t&&i()}}},t)}cc._RFpush(e,"7763fqe3GdAe7YxXNpcWD/Z","KeyPressHandler"),n.AddKeyPressHandler=o,cc._RFpop()},{}],Logo:[function(t,e,n){"use strict";cc._RFpush(e,"113feFvfsJMuICSI3B47906","Logo");var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},r=t("../lib/Global"),a=t("../lib/gremlins"),s=t("../lib/KeyPressHandler"),c=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e.prototype.onLoad=function(){this.editorName.string="u"+Math.floor(1e3*Math.random()),this.btnMask.node.active=!1,s.AddKeyPressHandler(this.node,{g:function(){a.Gremlins.instance.start()}})},e.prototype.onDisable=function(){if(null!=r.GetClient())return r.GetClient().handle.offLoginRsp(this,this.onLoginRsp)},e.prototype.onSinglePlayClick=function(){return this.btnMask.node.active=!0,r.PreloadSuccessNotice([],function(){return cc.director.loadScene("SinglePlay")})},e.prototype.onLoginClick=function(){var t="wss://sanguorush.xyz";(cc.sys.isMobile||cc.sys.isNative)&&(t="ws://sanguorush.xyz:5000"),r.CreateClient(t,this.editorName.string).handle.onLoginRsp(this,this.onLoginRsp),this.btnMask.node.active=!0},e.prototype.onCollectionClick=function(){return cc.director.loadScene("Collection")},e.prototype.onTutorialClick=function(){return cc.director.loadScene("Tutorial")},e.prototype.onLoginRsp=function(t){return t.isLogin?cc.director.loadScene("Main"):console.log(t)},e}(cc.Component);i([cc.Property(cc.EditBox)],c.prototype,"editorName",void 0),i([cc.Property(cc.Button)],c.prototype,"btnMask",void 0),c=i([cc.RegisterComponent],c),cc._RFpop()},{"../lib/Global":"Global","../lib/KeyPressHandler":"KeyPressHandler","../lib/gremlins":"gremlins"}],Main:[function(t,e,n){"use strict";cc._RFpush(e,"b57bbwfT7pG3o6jNWt/xH15","Main"),function(){var e;e=t("Global"),cc.Class({"extends":cc.Component,properties:{btnPvp:cc.Button,btnMask:cc.Button,labelTime:cc.Label,matchingTime:0},update:function(t){var e;return this.matchingTime+=t,null!=(e=this.labelTime)?e.string="匹配时间："+Math.floor(this.matchingTime)+"秒":void 0},onPvpClick:function(){var t;return null!=(t=e.GetClient())&&t.send(new client.MatchingReq),this.btnMask.node.active=!0,this.matchingTime=0},onFormationChangeClick:function(){return cc.director.loadScene("FormationChange")},onBackClick:function(){return e.GetClient().ws.close()},onEnable:function(){if(null!=e.GetClient())return e.GetClient().handle.onMatchingTimeoutNotice(this,this.onMatchingTimeoutNotice),e.GetClient().handle.onMatchingSuccessNotice(this,this.onMatchingSuccessNotice),e.GetClient().handle.onStopMatchingRsp(this,this.onStopMatchingRsp)},onDisable:function(){if(null!=e.GetClient())return e.GetClient().handle.offMatchingTimeoutNotice(this,this.onMatchingTimeoutNotice),e.GetClient().handle.offMatchingSuccessNotice(this,this.onMatchingSuccessNotice),e.GetClient().handle.offStopMatchingRsp(this,this.onStopMatchingRsp)},onMatchingSuccessNotice:function(t){return e.SuccessNotice=t,e.PreloadSuccessNotice([],function(){return cc.director.loadScene("MultiPlay")})},onMatchingTimeoutNotice:function(t){return this.btnMask.node.active=!1,e.ShowToolTips("没有找到合适的对手")},onStopMatchingRsp:function(t){return console.log(t)}})}.call(this),cc._RFpop()},{Global:"Global"}],MultiPlay:[function(t,e,n){"use strict";cc._RFpush(e,"079fb2bv0FJjLyIFPP23eLu","MultiPlay"),function(){var e,n,o,i;o=t("sgr").TeamCamp,e=t("AddDirectionTrigger").AddDirectionTrigger,i=t("TouchDragHandler").TouchDragHandler,n=t("Global"),cc.Class({"extends":cc.Component,properties:{stageController:{"default":null,type:t("StageController")},isRoomReady:!1},onLoad:function(){var t,r;if(null!=n.SuccessNotice)return console.log(n.SuccessNotice),t={blue:["200","106",n.SuccessNotice.formationList[0],["100","101","102"]],red:["201","107",n.SuccessNotice.formationList[1],["103","104","105"]],boss:"108"},null!=this.stageController?(this.stageController.isPreMoveTeam=!0,e(this),i(this.node,function(t){return function(e){return t.onDirectionTrigger(e)}}(this)),this.stageController.createStage(t),this.stageController.playerTeamCamp=0===n.SuccessNotice.userIndex?o.Blue:o.Red,(r=this.stageController).setPlayerNames.apply(r,n.SuccessNotice.accountList),n.GetClient().handle.onRoomReadyNotice(this,this.onRoomReadyNotice),n.GetClient().handle.onSetRoomUserDataNotice(this,this.onSetRoomUserDataNotice),n.GetClient().handle.onFrameNotice(this,this.onFrameNotice),n.GetClient().handle.onStopMatchingRsp(this,this.onStopMatchingRsp),n.GetClient().send(new client.UserIsReadyReq)):void 0},onDisable:function(){if(null!=n.GetClient())return n.GetClient().handle.offRoomReadyNotice(this,this.onRoomReadyNotice),n.GetClient().handle.offSetRoomUserDataNotice(this,this.onSetRoomUserDataNotice),n.GetClient().handle.offFrameNotice(this,this.onFrameNotice),n.GetClient().handle.offStopMatchingRsp(this,this.onStopMatchingRsp)},onDirectionTrigger:function(t){var e;return e=new client.SetRoomUserDataReq,e.data=t,n.GetClient().send(e)},onBackClick:function(){return n.GetClient().send(new client.StopMatchingReq)},onRoomReadyNotice:function(t){return this.isRoomReady=!0},onSetRoomUserDataNotice:function(t){var e,n;return e=0===t.userIndex?o.Blue:o.Red,n=t.data,this.stageController.stage.addCommand(e,n)},onFrameNotice:function(t){var e;if(e=t.ms,this.isRoomReady)return this.stageController.stage.addFrame(e/1e3)},onStopMatchingRsp:function(t){return cc.director.loadScene("Main")}})}.call(this),cc._RFpop()},{AddDirectionTrigger:"AddDirectionTrigger",Global:"Global",StageController:"StageController",TouchDragHandler:"TouchDragHandler",sgr:"sgr"}],PvpResultWin:[function(t,e,n){"use strict";cc._RFpush(e,"0345c5I8DNCc4ufeRUbYCP+","PvpResultWin"),function(){cc.Class({"extends":cc.Component,properties:{btnBack:cc.Button}})}.call(this),cc._RFpop()},{}],SinglePlay:[function(t,e,n){"use strict";cc._RFpush(e,"294d6z20KZEVZFkFfKoLaKt","SinglePlay"),function(){var e,n,o;n=t("sgr").TeamCamp,e=t("AddDirectionTrigger").AddDirectionTrigger,o=t("TouchDragHandler").TouchDragHandler,cc.Class({"extends":cc.Component,properties:{stageController:{"default":null,type:t("StageController")}},onLoad:function(){var t;if(t={blue:["200","106",["1","2","3","4","5"],["100","101","102"]],red:["201","107",["1","2","3","4","5"],["103","104","105"],!0],boss:"108"},null!=this.stageController)return e(this),o(this.node,function(t){return function(e){return t.stageController.stage.addCommand(n.Blue,e)}}(this)),this.stageController.createStage(t),this.stageController.setPlayerNames("blue","red")},update:function(t){return this.stageController.stage.addFrame(t)},onDirectionTrigger:function(t,e){var o;return o=e?n.Blue:n.Red,this.stageController.stage.addCommand(o,t)},onBackClick:function(){return cc.director.loadScene("Logo")}})}.call(this),cc._RFpop()},{AddDirectionTrigger:"AddDirectionTrigger",StageController:"StageController",TouchDragHandler:"TouchDragHandler",sgr:"sgr"}],StageController:[function(t,e,n){"use strict";cc._RFpush(e,"260a8+ZHg1IaaUCqqB6npyQ","StageController"),function(){var e,n,o,i,r,a,s,c,l,u,p=[].slice;u=t("sgr"),s=u.Map,c=u.Stage,o=u.ConfigStage,i=u.Directions,l=u.TeamCamp,n=u.CommandPlayStage,e=t("KeyPressHandler").AddKeyPressHandler,r=t("Global"),a=["OnTeamAddMember","OnBaseTeamRemoved","OnPlayerTeamSupply","OnTracerBulletCreated","OnBulletCreated","OnBombCreated","OnHeroHurt","OnHeroHeal","OnBombExplosion","OnDropCoinItem","OnDropHeroItem","OnDropItemCoinGet","OnDropItemHeroGet","OnDrawTimecountDone","OnBossTeamRemoved"],cc.Class({"extends":cc.Component,properties:{heroPrefab:cc.Prefab,rootNode:cc.Node,hpBarNode:cc.Node,timeLabel:cc.Label,playerTeamCamp:{"default":l.Blue,visible:!1},labelPlayer1:cc.Label,labelPlayer2:cc.Label,winResultPanel:cc.Node,failResultPanel:cc.Node,drawResultPanel:cc.Node,isPreMoveTeam:!1},showResult:function(t){if(null!=this.winResultPanel&&(this.winResultPanel.active=t),null!=this.failResultPanel)return this.failResultPanel.active=!t},playEffect:function(t){return cc.loader.loadRes("audio/effect/"+t,function(t,e){return cc.audioEngine.playEffect(e,!1)})},createStage:function(t){var o,i,s,c,u;for(this.isGameDone=!1,this.stage=new n,i=0,s=a.length;i<s;i++)o=a[i],this.stage.on(o,this);if((c=this.stage).createBase.apply(c,[l.Blue].concat(p.call(t.blue))),null!=t.red&&(u=this.stage).createBase.apply(u,[l.Red].concat(p.call(t.red))),this.stage.createBoss(t.boss),this.stage.createDrawTimecount(60),r.IsGMEnabled)return e(this.node,{1:function(t){return function(){return t.isGameDone=!0,t.showResult(!0)}}(this),2:function(t){return function(){return t.isGameDone=!0,t.showResult(!1)}}(this)})},clamp:function(t,e,n){return Math.min(Math.max(t,e),n)},focusFollowTeam:function(){var t,e,n;return n=this.stage.getPlayerTeamPosition(this.playerTeamCamp),t=200,e=400,this.rootNode.setPositionX(-this.clamp(n.x,t,s.MaxSize.x-t)),this.rootNode.setPositionY(-this.clamp(n.y,e,s.MaxSize.y-e))},update:function(t){var e,n;if(null!=this.timeLabel&&(n=this.stage.maxStageTime-this.stage.getTotalSecond(),n<0&&(n=0),e=Math.floor(n/60),n=Math.floor(n%60),this.timeLabel.string=e+":"+n),!this.isGameDone&&null!=this.stage)return this.stage.update(t),this.focusFollowTeam()},setPlayerNames:function(t,e){var n,o;return null!=(n=this.labelPlayer1)&&(n.string=t),null!=(o=this.labelPlayer2)?o.string=e:void 0},onDestroy:function(){var t,e,n,o,i;for(i=[],e=0,n=a.length;e<n;e++)t=a[e],i.push(null!=(o=this.stage)?o.off(t,this):void 0);return i},OnTeamAddMember:function(t){var e,n;return e=cc.instantiate(this.heroPrefab),e.parent=this.node,n=e.getComponent("Hero"),n.init(t),n.setHpColor(t.team.camp===l.Blue?cc.Color.GREEN:cc.Color.RED),n.hideHp(),n.setHpParentNode(this.hpBarNode)},OnBaseTeamRemoved:function(t){return this.showResult(this.playerTeamCamp!==t.camp),this.isGameDone=!0},OnPlayerTeamSupply:function(t){return r.ShowToolTips("获取了主将的补给")},OnHeroHurt:function(t,e){var n,o;return o=new cc.Node("damage"),n=o.addComponent(cc.Label),o.parent=this.node,o.setPosition(t.gameObject.position.x,t.gameObject.position.y),n.string="-"+Math.floor(e),o.opacity=0,o.color=cc.Color.RED,o.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.5),cc.callFunc(o.removeFromParent,o)))},OnHeroHeal:function(t,e){var n,o;return o=new cc.Node("health"),n=o.addComponent(cc.Label),o.parent=this.node,o.setPosition(t.gameObject.position.x,t.gameObject.position.y),n.string="+"+Math.floor(e),o.opacity=0,o.color=cc.Color.GREEN,o.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.5),cc.callFunc(o.removeFromParent,o)))},OnBombExplosion:function(t){var e,n,o;return e=new cc.Node(""),e.zIndex=-1,e.setPosition(t.gameObject.position.x,t.gameObject.position.y),e.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.5),cc.callFunc(e.removeFromParent,e))),e.scale=t.range/100,e.parent=this.node,n=e.addComponent(cc.Sprite),o=cc.url.raw("resources/effect/cycle.png"),n.spriteFrame=new cc.SpriteFrame(o),this.playEffect("boom")},OnTracerBulletCreated:function(t){var e;return e=new cc.Node,e.parent=this.node,e.addComponent("TracerBullet").initTracerBullet(t),this.playEffect("emit")},OnBulletCreated:function(t){var e;return e=new cc.Node,e.parent=this.node,e.addComponent("Bullet").initBullet(t),this.playEffect("emit")},OnBombCreated:function(t){var e;return e=new cc.Node,e.parent=this.node,e.addComponent("Bomb").initBomb(t),this.playEffect("emit")},OnDropCoinItem:function(t){var e;return e=new cc.Node,e.parent=this.node,e.addComponent("DropItemCoin").init(t)},OnDropHeroItem:function(t){var e;return e=new cc.Node,e.parent=this.node,e.addComponent("DropItemHero").init(t)},OnDropItemCoinGet:function(){return cc.loader.loadRes("audio/effect/coin",function(t,e){return cc.audioEngine.playEffect(e,!1)})},OnDropItemHeroGet:function(){return cc.loader.loadRes("audio/effect/hero",function(t,e){return cc.audioEngine.playEffect(e,!1)})},OnDrawTimecountDone:function(){if(null!=this.drawResultPanel)return this.isGameDone=!0,this.drawResultPanel.active=!0},OnBossTeamRemoved:function(){return r.ShowToolTips("Boss被击杀，获取强力buff")}})}.call(this),cc._RFpop()},{Global:"Global",KeyPressHandler:"KeyPressHandler",sgr:"sgr"}],StageEventHandle:[function(t,e,n){"use strict";cc._RFpush(e,"f5ff78edPdNPJQAq/SZRqCg","StageEventHandle"),function(){var e,n,o,i,r,a,s;s=t("sgr"),n=s.ConfigStage,o=s.Directions,a=s.TeamCamp,i=s.ForeverStage,e=s.CommandStage,r=["OnTeamAddMember","OnTracerBulletCreated","OnBulletCreated","OnBombCreated","OnHeroHurt","OnHeroHeal","OnBombExplosion","OnDropCoinItem","OnDropHeroItem"],cc.Class({"extends":cc.Component,properties:{heroPrefab:{"default":null,type:cc.Prefab}},setStage:function(t){var e,n,o,i,a;for(this.stage=t,a=[],n=0,o=r.length;n<o;n++)e=r[n],a.push(null!=(i=this.stage)?i.on(e,this):void 0);return a},onDestroy:function(){var t,e,n,o,i;for(i=[],e=0,n=r.length;e<n;e++)t=r[e],i.push(null!=(o=this.stage)?o.off(t,this):void 0);
return i},OnTeamAddMember:function(t){var e,n;return e=cc.instantiate(this.heroPrefab),e.parent=this.node,n=e.getComponent("Hero"),n.init(t),n.setHpColor(t.team.camp===a.Blue?cc.Color.GREEN:cc.Color.RED),n.hideHp()},OnHeroHurt:function(t,e){var n,o;return o=new cc.Node("damage"),n=o.addComponent(cc.Label),o.parent=this.node,o.setPosition(t.gameObject.position.x,t.gameObject.position.y),n.string="-"+Math.floor(e),o.opacity=0,o.color=cc.Color.RED,o.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.5),cc.callFunc(o.removeFromParent,o)))},OnHeroHeal:function(t,e){var n,o;return o=new cc.Node("health"),n=o.addComponent(cc.Label),o.parent=this.node,o.setPosition(t.gameObject.position.x,t.gameObject.position.y),n.string="+"+Math.floor(e),o.opacity=0,o.color=cc.Color.GREEN,o.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.5),cc.callFunc(o.removeFromParent,o)))},OnBombExplosion:function(t){var e,n,o;return e=new cc.Node(""),e.zIndex=-1,e.setPosition(t.gameObject.position.x,t.gameObject.position.y),e.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.5),cc.callFunc(e.removeFromParent,e))),e.scale=t.range/100,e.parent=this.node,n=e.addComponent(cc.Sprite),o=cc.url.raw("resources/effect/cycle.png"),n.spriteFrame=new cc.SpriteFrame(o)},OnTracerBulletCreated:function(t){var e;return e=new cc.Node,e.parent=this.node,e.addComponent("TracerBullet").initTracerBullet(t)},OnBulletCreated:function(t){var e;return e=new cc.Node,e.parent=this.node,e.addComponent("Bullet").initBullet(t)},OnBombCreated:function(t){var e;return e=new cc.Node,e.parent=this.node,e.addComponent("Bomb").initBomb(t)},OnDropCoinItem:function(t){var e;return e=new cc.Node,e.parent=this.node,e.addComponent("DropItemCoin").init(t)},OnDropHeroItem:function(t){var e;return e=new cc.Node,e.parent=this.node,e.addComponent("DropItemHero").init(t)}})}.call(this),cc._RFpop()},{sgr:"sgr"}],ToolTips:[function(t,e,n){"use strict";cc._RFpush(e,"ba83eolROlI+668a6Z0BVbG","ToolTips"),function(){cc.Class({"extends":cc.Component,properties:{content:cc.Label},onLoad:function(){return console.log("ToolTips onLoad")},setContent:function(t){return this.content.string=t}})}.call(this),cc._RFpop()},{}],TouchDragHandler:[function(t,e,n){"use strict";function o(t,e){if(null!=t){var n=cc.p();t.on(cc.Node.EventType.TOUCH_START,function(t){n=t.touch.getLocation()}),t.on(cc.Node.EventType.TOUCH_END,function(t){if(!(cc.pDistance(t.touch.getLocation(),n)<10)){var o=cc.pSub(t.touch.getLocation(),n),r=cc.pToAngle(o);e(r<3*-Math.PI/4?i.Directions.Left:r<-Math.PI/4?i.Directions.Down:r<Math.PI/4?i.Directions.Right:r<=3*Math.PI/4?i.Directions.Up:i.Directions.Left)}})}}cc._RFpush(e,"7cdd1n8UFBI+Z4vamo0FcPc","TouchDragHandler");var i=t("sgr");n.TouchDragHandler=o,cc._RFpop()},{sgr:"sgr"}],TracerBullet:[function(t,e,n){"use strict";cc._RFpush(e,"35f2epR1uNElrztnW95bwuO","TracerBullet"),function(){cc.Class({"extends":cc.Component,initTracerBullet:function(t){var e,n,o;return this.tracerBullet=t,e=new cc.Node,e.parent=this.node,n=e.addComponent(cc.Sprite),o=cc.url.raw("resources/effect/bullet.png"),n.spriteFrame=new cc.SpriteFrame(o),this.updatePosition(),this.tracerBullet.on("OnTracerBulletFinish",this)},update:function(t){return this.updatePosition()},updatePosition:function(){if(null!=this.tracerBullet)return this.node.setPosition(this.tracerBullet.gameObject.position.x,this.tracerBullet.gameObject.position.y)},OnTracerBulletFinish:function(t){if(t===this.tracerBullet)return this.tracerBullet.off("OnTracerBulletFinish",this),this.node.destroy()}})}.call(this),cc._RFpop()},{}],Tutorial:[function(t,e,n){"use strict";cc._RFpush(e,"5be33MbQm9JTahMZbmQZO4B","Tutorial");var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},r=t("../lib/TouchDragHandler"),a=t("sgr"),s=function(t){function e(){var e=t.apply(this,arguments)||this;return e.isForbidDrag=!0,e.isInDragPause=!1,e.isFirstDrag=!0,e}return o(e,t),e.prototype.onLoad=function(){var t=this;this.text.string="欢迎来到冲击英雄的世界，我们会花一点点时间，熟悉游戏的基本操作。";var e={blue:["200","106",["1","2","3","4","5"],["100","101","102"]],boss:"108"};this.stageController&&(r.TouchDragHandler(this.node,function(e){if(!t.isForbidDrag){if(t.isFirstDrag){if(e!=a.Directions.Right)return;t.isFirstDrag=!1,t.isInDragPause=!1,t.text.string="地图中央有一个强力的boss，击杀后，可以获得强力buff。"}t.stageController.stage.addCommand(a.TeamCamp.Blue,e)}}),this.stageController.createStage(e),this.scheduleOnce(function(){t.text.string="英雄们会自己进行移动，向右滑动，可以调整英雄的行走方向，试试吧。",t.isInDragPause=!0,t.isForbidDrag=!1},2),this.stageController.stage.on("OnBossTeamRemoved",this,this.onKillBoss))},e.prototype.update=function(t){this.isInDragPause||this.stageController.stage.addFrame(t)},e.prototype.onKillBoss=function(){this.stageController.stage.off("OnBossTeamRemoved",this,this.onKillBoss),this.text.string="恭喜您，击杀了boss，我们新手引导即将结束。",this.scheduleOnce(function(){return cc.director.loadScene("Logo")},5)},e}(cc.Component);i([cc.Property(cc.Label)],s.prototype,"text",void 0),i([cc.Property({"default":null,type:t("StageController")})],s.prototype,"stageController",void 0),s=i([cc.RegisterComponent],s),cc._RFpop()},{"../lib/TouchDragHandler":"TouchDragHandler",StageController:"StageController",sgr:"sgr"}],gremlins:[function(t,e,n){"use strict";cc._RFpush(e,"5533fK0DARCRoRYJbdcemjd","gremlins");var o=function(){function t(){this.timer=null}return t.prototype.start=function(){var t=this;this.isEnable()||(this.timer=setInterval(function(){if(Math.random()<.1){var e=t.createHorde("●");t.hordeScroll(e)}else{var e=t.createHorde("○");t.hordeTouch(e)}},200))},t.prototype.stop=function(){null!=this.timer&&(clearInterval(this.timer),this.timer=null)},t.prototype.isEnable=function(){return null!=this.timer},t.prototype.createHorde=function(t){void 0===t&&(t="○");var e=new cc.Node,n=e.addComponent(cc.Label);return n.string=t,e.parent=cc.director.getScene(),e.setPosition(cc.v2(Math.random()*cc.director.getVisibleSize().width,Math.random()*cc.director.getVisibleSize().height)),e.color=cc.Color.RED,e.opacity=0,e},t.prototype.hordeTouch=function(t){var e=new cc.Touch;e.setTouchInfo(0,t.getPositionX(),t.getPositionY()),t.runAction(cc.sequence(cc.callFunc(function(){var t=new cc.Event.EventTouch([e],(!0));t._eventCode=cc.Event.EventTouch.BEGAN,cc.eventManager.dispatchEvent(t)}),cc.fadeIn(.2),cc.callFunc(function(){var t=new cc.Event.EventTouch([e],(!0));t._eventCode=cc.Event.EventTouch.ENDED,cc.eventManager.dispatchEvent(t)}),cc.fadeOut(.5),cc.callFunc(function(){this.removeFromParent()},t)))},t.prototype.hordeScroll=function(t){var e=new cc.Touch;e.setTouchInfo(0,t.getPositionX(),t.getPositionY()),t.runAction(cc.sequence(cc.callFunc(function(){var t=new cc.Event.EventTouch([e],(!0));t._eventCode=cc.Event.EventTouch.BEGAN,cc.eventManager.dispatchEvent(t)}),cc.fadeIn(.2),cc.moveBy(.5,200*Math.random()-100,200*Math.random()-100),cc.callFunc(function(){e.setTouchInfo(0,t.getPositionX(),t.getPositionY());var n=new cc.Event.EventTouch([e],(!0));n._eventCode=cc.Event.EventTouch.ENDED,cc.eventManager.dispatchEvent(n)}),cc.fadeOut(.5),cc.callFunc(function(){this.removeFromParent()},t)))},t}();o.instance=new o,n.Gremlins=o,cc._RFpop()},{}],sgr:[function(t,e,n){"use strict";cc._RFpush(e,"d31f1mrV5dNVIXkKkGhEz4v","sgr"),function(t,o){"object"==typeof n&&"object"==typeof e?e.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof n?n.sgr=o():t.sgr=o()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var o=n(1);e.World=o.World;var i=n(6);e.Component=i.Component;var r=n(3);e.GameObject=r.GameObject;var a=n(5);e.EventDispatcher=a.EventDispatcher;var s=n(4);e.vec2=s.vec2,e.v2=s.v2;var c=n(7);e.Stage=c.Stage,e.CommandPlayStage=c.CommandPlayStage;var l=n(15);e.Directions=l.Directions;var u=n(14);e.Map=u.Map;var p=n(12);e.TeamCamp=p.TeamCamp;var h=n(24);e.Config=h.Config;var m=n(8);e.ConfigToComponent=m.ConfigToComponent;var d=n(35);e.Dice=d.Dice;var g=n(11);e.Timer=g.Timer;var f=n(36);e.DropItemType=f.DropItemType;var y=n(38);e.Components=y},function(t,e,n){var o=n(2),i=n(3),r=n(5),a=function(){function t(t){void 0===t&&(t=0),this.root=new i.GameObject,this.root.world=this,this.eventDispatcher=new r.EventDispatcher,this.rng=new o.RNG(t)}return t.prototype.createGameObject=function(t){return void 0===t&&(t=""),this.root.createChild(t)},t.prototype.update=function(t){void 0===t&&(t=0),this.root.update(t)},t.prototype.nextInt=function(){return this.rng.nextInt()},t.prototype.nextFloat=function(){return this.rng.nextFloat()},t.prototype.nextIndex=function(t){return this.rng.nextRange(0,t)},t.prototype.nextRange=function(t,e){return this.rng.nextRange(t,e)},t.prototype.choice=function(t){return this.rng.choice(t)},t.prototype.on=function(t,e,n){this.eventDispatcher.on(t,e,n)},t.prototype.off=function(t,e,n){this.eventDispatcher.off(t,e,n)},t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];(o=this.eventDispatcher).trigger.apply(o,[t].concat(e));var o},t.prototype.onEventMap=function(t){for(var e in t)this.on(e,t)},t}();e.World=a},function(t,e){var n=function(){function t(t){void 0===t&&(t=0),this.m=2147483648,this.a=1103515245,this.c=12345,this.state=t}return t.prototype.nextInt=function(){return this.state=(this.a*this.state+this.c)%this.m,this.state},t.prototype.nextFloat=function(){return this.nextInt()/(this.m-1)},t.prototype.random=function(){return this.nextInt()/this.m},t.prototype.nextRange=function(t,e){var n=e-t,o=this.nextInt()/this.m;return t+Math.floor(o*n)},t.prototype.choice=function(t){return t[this.nextRange(0,t.length)]},t}();e.RNG=n},function(t,e,n){var o=n(4),i=function(){function t(t){void 0===t&&(t=""),this.tag="",this.children=[],this.position=o.v2(),this.componentList=[],this.name=t}return t.prototype.createChild=function(e){void 0===e&&(e="");var n=new t(e);return n.world=this.world,n.parent=this,this.children.push(n),n},t.prototype.removeChild=function(t){if(null!=t)for(var e in this.children)this.children[e]===t&&(this.children[e].cleanup(),this.children[e]=null)},t.prototype.removeAllChildren=function(){for(var t in this.children)null!=this.children[t]&&(this.children[t].cleanup(),this.children[t]=null)},t.prototype.cleanup=function(){for(var t=0,e=this.children;t<e.length;t++){var n=e[t];n.cleanup()}this.parent=null,this.children=[];for(var o=0,i=this.componentList;o<i.length;o++){var r=i[o];null!=this.world&&r.onDisable()}this.componentList=[]},t.prototype.removeFromParent=function(){null!=this.parent&&this.parent.removeChild(this)},t.prototype.isChild=function(t,e){void 0===e&&(e=this.children);for(var n=0,o=e;n<o.length;n++){var i=o[n];if(i===t)return!0}return!1},t.prototype.addComponent=function(t){var e=new t;return e.gameObject=this,this.componentList.push(e),null!=this.world&&e.onEnable(),e},t.prototype.getComponent=function(t){for(var e=0,n=this.componentList;e<n.length;e++){var o=n[e];if(o instanceof t)return o}return null},t.prototype.removeComponent=function(t){for(var e=0;e<this.componentList.length;++e)if(this.componentList[e]===t){var n=this.componentList[e];return this.componentList.splice(e,1),null!=this.world&&n.onDisable(),n}return null},t.prototype.cleanChildren=function(){this.children=this.children.filter(function(t,e,n){return null!=t})},t.prototype.update=function(t){this.cleanChildren();for(var e=0,n=this.componentList;e<n.length;e++){var o=n[e];o.update(t)}for(var i=0,r=this.children;i<r.length;i++){var a=r[i];null!=a&&a.update(t)}},t}();e.GameObject=i},function(t,e){function n(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),new o([t,e])}var o=function(){function t(t){void 0===t&&(t=null),this.values=new Float32Array(2),t&&(this.xy=t)}return Object.defineProperty(t.prototype,"x",{get:function(){return this.values[0]},set:function(t){this.values[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.values[1]},set:function(t){this.values[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1]},enumerable:!0,configurable:!0}),t.prototype.at=function(t){return this.values[t]},t.prototype.reset=function(){this.x=0,this.y=0},t.prototype.copy=function(e){return void 0===e&&(e=null),e||(e=new t),e.x=this.x,e.y=this.y,e},t.prototype.negate=function(t){return void 0===t&&(t=null),t||(t=this),t.x=-this.x,t.y=-this.y,t},t.prototype.equals=function(t){return this.x===t.x&&this.y==t.y},t.prototype.length=function(){return Math.sqrt(this.squaredLength())},t.prototype.squaredLength=function(){var t=this.x,e=this.y;return t*t+e*e},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},t.prototype.scale=function(t,e){return void 0===e&&(e=null),e||(e=this),e.x*=t,e.y*=t,e},t.prototype.normalize=function(t){void 0===t&&(t=null),t||(t=this);var e=this.length();return 1===e?this:0===e?(t.x=0,t.y=0,t):(e=1/e,t.x*=e,t.y*=e,t)},t.prototype.toString=function(){return"{x: "+this.x+", y: "+this.y+"}"},t.dot=function(t,e){return t.x*e.x+t.y*e.y},t.distance=function(t,e){return Math.sqrt(this.squaredDistance(t,e))},t.squaredDistance=function(t,e){var n=e.x-t.x,o=e.y-t.y;return n*n+o*o},t.direction=function(e,n,o){void 0===o&&(o=null),o||(o=new t);var i=e.x-n.x,r=e.y-n.y,a=Math.sqrt(i*i+r*r);return 0===a?(o.x=0,o.y=0,o):(a=1/a,o.x=i*a,o.y=r*a,o)},t.mix=function(e,n,o,i){void 0===i&&(i=null),i||(i=new t);var r=e.x,a=e.y,s=n.x,c=n.y;return i.x=r+o*(s-r),i.y=a+o*(c-a),i},t.sum=function(e,n,o){return void 0===o&&(o=null),o||(o=new t),o.x=e.x+n.x,o.y=e.y+n.y,o},t.difference=function(e,n,o){return void 0===o&&(o=null),o||(o=new t),o.x=e.x-n.x,o.y=e.y-n.y,o},t.product=function(e,n,o){return void 0===o&&(o=null),o||(o=new t),o.x=e.x*n.x,o.y=e.y*n.y,o},t.quotient=function(e,n,o){return void 0===o&&(o=null),o||(o=new t),o.x=e.x/n.x,o.y=e.y/n.y,o},t.contains=function(e,n,o){return void 0===o&&(o=t.zero),o.x<=n.x&&n.x<=e.x&&o.y<=n.y&&n.y<=e.y},t}();o.zero=new o([0,0]),e.vec2=o,e.v2=n},function(t,e){var n=function(){function t(){this._eventInvokerMap={}}return t.prototype.getInvokerList=function(t){return this._eventInvokerMap[t]||[]},t.prototype.on=function(t,e,n){void 0===n&&(n=e[t]),null==this._eventInvokerMap[t]&&(this._eventInvokerMap[t]=[]),null!=e&&this._eventInvokerMap[t].push({target:e,handler:n})},t.prototype.off=function(t,e,n){void 0===n&&(n=e[t]),null!=this._eventInvokerMap[t]&&(this._eventInvokerMap[t]=this._eventInvokerMap[t].filter(function(t,o,i){return e!==t.target||n!==t.handler}))},t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var o=0,i=this.getInvokerList(t);o<i.length;o++){var r=i[o];(a=r.handler).call.apply(a,[r.target].concat(e))}var a},t}();e.EventDispatcher=n},function(t,e){var n=function(){function t(){}return t.prototype.onEnable=function(){},t.prototype.onDisable=function(){},t.prototype.isEnable=function(){return null!=this.gameObject&&null!=this.gameObject.parent},t.prototype.update=function(t){},t.prototype.on=function(t,e,n){this.gameObject.world.on(t,e,n)},t.prototype.off=function(t,e,n){this.gameObject.world.off(t,e,n)},t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];(o=this.gameObject.world).trigger.apply(o,[t].concat(e));var o},t}();e.Component=n},function(t,e,n){var o,i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(8),a=n(14),s=n(34),c=n(4),l=n(12),u=n(15),p=n(1);!function(t){t[t.Base=0]="Base",t[t.Tower=1]="Tower"}(o=e.MapPositionType||(e.MapPositionType={}));var h={};h[l.TeamCamp.Blue]={},h[l.TeamCamp.Blue][o.Base]=c.v2(.2,.2),h[l.TeamCamp.Blue][o.Tower]=c.v2(.2,.8),h[l.TeamCamp.Red]={},h[l.TeamCamp.Red][o.Base]=c.v2(.8,.8),h[l.TeamCamp.Red][o.Tower]=c.v2(.8,.2);var m=function(){function t(){this.totalSecond=0,this.maxStageTime=10,this.baseTeamMap={},this.world=new p.World,this.teamManager=this.world.createGameObject().addComponent(s.TeamManager)}return t.prototype.getTotalSecond=function(){return this.totalSecond},t.prototype.update=function(t){this.world.update(t),this.totalSecond+=t},t.prototype.on=function(t,e,n){this.world.on(t,e,n)},t.prototype.off=function(t,e,n){this.world.off(t,e,n)},t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];(o=this.world).trigger.apply(o,[t].concat(e));var o},t.prototype.createPlayerTeam=function(t,e){void 0===e&&(e=l.TeamCamp.Blue);for(var n=e===l.TeamCamp.Blue?u.Directions.Up:u.Directions.Down,o=c.v2(a.Map.MaxSize.x*(e===l.TeamCamp.Blue?.2:.8),a.Map.MaxSize.y*(e===l.TeamCamp.Blue?.2:.8)),i=[],s=0,p=t;s<p.length;s++){var h=p[s],m=this.world.createGameObject();i.push(r.ConfigToComponent.createHero(h,m))}return i[0].direction=n,this.teamManager.createPlayerTeam(i,o,e)},t.prototype.createBase=function(t,e,n,i,r,a){void 0===a&&(a=!1);var s=this.world.createGameObject().addComponent(l.BaseTeam);return s.gameObject.position=this.getMapPosition(t,o.Base),s.teamManager=this.teamManager,s.camp=t,s.directionList=t===l.TeamCamp.Blue?[u.Directions.Up,u.Directions.Right]:[u.Directions.Down,u.Directions.Left],s.isRandomMove=a,s.initMain(e),s.initPlayerTeam(i),s.createHeroIdList=r,s.initTowerTeam(n,this.getMapPosition(t,o.Tower)),this.baseTeamMap[t]=s,s},t.prototype.createBoss=function(t){var e=r.ConfigToComponent.createHero(t,this.world.createGameObject());e.gameObject.position=a.Map.getCenter(),e.direction=u.Directions.Down;var n=e.gameObject.addComponent(l.BossTeam);n.teamManager=this.teamManager,n.camp=l.TeamCamp.Neutral,n.setMemberList([e]),this.teamManager.teamList.push(n)},t.prototype.createDrawTimecount=function(t){if(void 0===t&&(t=10),null!=this.world){this.maxStageTime=t;var e=this.world.createGameObject().addComponent(l.Countdown);e.timer.interval=this.maxStageTime,e.eventName="OnDrawTimecountDone"}},t.prototype.getRandomMapPosition=function(){return a.Map.getRandomPosition(this.world.nextFloat(),this.world.nextFloat())},t.prototype.getMapPosition=function(t,e){var n=h[t][e].copy();return n.multiply(a.Map.MaxSize)},t.prototype.getPlayerTeamPosition=function(t){var e=this.baseTeamMap[t];return null==e?c.v2():null!=e.playerTeam?e.playerTeam.getLeaderPosition():e.getLeaderPosition()},t}();e.Stage=m;var d=function(t){function e(){var e=t.apply(this,arguments)||this;return e.frames=[],e.commandMap={},e.isPlayToLastFrame=!0,e.totalPlayTime=0,e.curPlayTime=0,e.curFrameIndex=0,e}return i(e,t),e.prototype.addFrame=function(t){this.frames.push(t),this.totalPlayTime+=t},e.prototype.addCommand=function(t,e){var n=this.frames.length;null==this.commandMap[n]&&(this.commandMap[n]={});var o=this.commandMap[n];o[t]=e},e.prototype.triggerCommand=function(t){var e=this.commandMap[t];if(null!=e)for(var n in e)this.world.trigger("OnTriggerDirection",e[n],Number(n))},e.prototype.update=function(t){for(void 0===t&&(t=0);this.curFrameIndex<this.frames.length;){var e=this.frames[this.curFrameIndex];this.curPlayTime+=e,this.triggerCommand(this.curFrameIndex),this.world.update(e),++this.curFrameIndex}},e.prototype.updateByPreMoveTeam=function(t){if(void 0===t&&(t=0),this.curFrameIndex>=this.frames.length)for(var e=0,n=this.teamManager.teamList;e<n.length;e++){var o=n[e];o.moveMembersWithoutFollow(t)}else{for(var i=0,r=this.teamManager.teamList;i<r.length;i++){var o=r[i];o.loadFormation()}this.update(t);for(var a=0,s=this.teamManager.teamList;a<s.length;a++){var o=s[a];o.recordFormation()}}},e.prototype.getTotalSecond=function(){return this.curPlayTime},e}(m);e.CommandPlayStage=d},function(t,e,n){var o=n(9),i=n(16),r=n(17),a=n(18),s=n(19),c=n(21),l=n(22),u=n(23),p=n(15),h=n(24),m={BombEmitter:function(t,e,n){var o=h.Config.bombEmitterDic.find(t);if(null!=o){var i=e.addComponent(s.BombEmitter);return i.id=o.id.toString(),i.range=Number(o.range),i.cooldown.interval=Number(o.cooldown),i.bombRange=Number(o.bombRange),i.damage=Number(o.damage)*d.getPropertyScale(n),i.speed=Number(o.speed),i}return null},BulletEmitter:function(t,e,n){var o=h.Config.bulletEmitterDic.find(t);if(null!=o){var i=e.addComponent(l.BulletEmitter);return i.id=o.id.toString(),i.range=Number(o.range),i.cooldown.interval=Number(o.cooldown),i.bulletRange=Number(o.bulletRange),i.damage=Number(o.damage)*d.getPropertyScale(n),i.speed=Number(o.speed),i}return null},CycleAOE:function(t,e,n){var o=h.Config.cycleAOEDic.find(t);if(null!=o){var i=e.addComponent(c.CycleAOE);return i.id=o.id.toString(),i.range=Number(o.range),i.cooldown.interval=Number(o.cooldown),i.damage=Number(o.damage)*d.getPropertyScale(n),i}return null},HalfCycleAOE:function(t,e,n){var o=h.Config.halfCycleAOEDic.find(t);if(null!=o){var i=e.addComponent(a.HalfCycleAOE);return i.id=o.id.toString(),i.range=Number(o.range),i.cooldown.interval=Number(o.cooldown),i.damage=Number(o.damage)*d.getPropertyScale(n),i}return null},Heal:function(t,e,n){var o=h.Config.healDic.find(t);if(null!=o){var i=e.addComponent(u.Heal);return i.id=o.id.toString(),i.range=Number(o.range),i.cooldown.interval=Number(o.cooldown),i.health=Number(o.health)*d.getPropertyScale(n),i}return null},RectangleAOE:function(t,e,n){var o=h.Config.rectangleAOEDic.find(t);if(null!=o){var i=e.addComponent(r.RectangleAOE);return i.id=o.id.toString(),i.range=Number(o.range),i.cooldown.interval=Number(o.cooldown),i.damage=Number(o.damage)*d.getPropertyScale(n),i.width=Number(o.width),i}return null},Snipe:function(t,e,n){var o=h.Config.snipeDic.find(t);if(null!=o){var r=e.addComponent(i.Snipe);return r.id=o.id.toString(),r.range=Number(o.range),r.cooldown.interval=Number(o.cooldown),r.damage=Number(o.damage)*d.getPropertyScale(n),r.readyTime=Number(o.readyTime),r}return null},TracerBulletEmitter:function(t,e,n){var i=h.Config.tracerBulletEmitterDic.find(t);if(null!=i){var r=e.addComponent(o.TracerBulletEmitter);return r.id=i.id.toString(),r.range=Number(i.range),r.cooldown.interval=Number(i.cooldown),r.damage=Number(i.damage)*d.getPropertyScale(n),r.speed=Number(i.speed),r}return null}},d=function(){function t(){}return t.getPropertyScale=function(t){return void 0===t&&(t=1),t<1?1:.1*t+.9},t.createHero=function(t,e,n){void 0===n&&(n=1);var o=h.Config.heroDic.find(t),i=e.addComponent(p.Hero);i.id=o.id.toString(),i.hp=i.maxHp=o.hp*this.getPropertyScale(n);var r=this.createSkill(o.skillId.toString(),o.skill,e,n);return null!=r&&(r.owner=i),i},t.createHeroList=function(t,e,n){for(var o=[],i=0,r=t;i<r.length;i++){var a=r[i];o.push(this.createHero(a,e.createGameObject(),n))}return o},t.setSkillBase=function(t,e){t.range=Number(e.range),t.cooldown.interval=Number(e.cooldown)},t.createSkill=function(t,e,n,o){void 0===o&&(o=1);var i=m[e];return null!=i?i(t,n,o):null},t}();e.ConfigToComponent=d},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(10),r=n(12),a=n(4),s=n(6),c=function(t){function e(){var e=t.apply(this,arguments)||this;return e.damage=0,e.speed=0,e}return o(e,t),e.prototype.onUseSkill=function(){var t=this.getNearestTarget();if(null!=t){var e=this.gameObject.world.createGameObject().addComponent(l);e.gameObject.position.xy=this.gameObject.position.xy,e.damage=this.damage,e.speed=this.speed,e.target=t,e.camp=this.getCamp(),this.trigger("OnTracerBulletCreated",e)}},e}(i.Skill);e.TracerBulletEmitter=c;var l=function(t){function e(){var e=t.apply(this,arguments)||this;return e.missPosition=a.v2(0,0),e.damage=0,e.speed=0,e.camp=r.TeamCamp.Neutral,e.target=null,e}return o(e,t),e.prototype.onEnable=function(){this.on("OnHeroDead",this)},e.prototype.onDisable=function(){this.off("OnHeroDead",this)},e.prototype.OnHeroDead=function(t){t===this.target&&(this.missPosition.xy=t.gameObject.position.xy)},e.prototype.moveByDistance=function(t,e){var n=t.copy().subtract(this.gameObject.position);n.normalize().scale(e),this.gameObject.position.add(n)},e.prototype.getTargetPosition=function(){return null==this.target?this.missPosition:this.target.gameObject.position},e.prototype.getTargetDistance=function(){var t=this.gameObject.position.copy().subtract(this.getTargetPosition());return t.length()},e.prototype.update=function(t){var e=t*this.speed;e<this.getTargetDistance()?this.moveByDistance(this.getTargetPosition(),e):(null!=this.target&&this.target.hurt(this.damage,this.camp),this.gameObject.position.xy=this.getTargetPosition().xy,this.trigger("OnTracerBulletFinish",this),this.gameObject.removeFromParent())},e}(s.Component);e.TracerBullet=l},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(11),r=n(4),a=n(6),s=n(12),c=function(t){function e(){var e=t.apply(this,arguments)||this;return e.owner=null,e.id="",e.range=0,e.cooldown=new i.Timer(1),e}return o(e,t),e.prototype.getTeamManager=function(){return null!=this.owner&&null!=this.owner.team?this.owner.team.teamManager:null},e.prototype.getCamp=function(){return null!=this.owner&&null!=this.owner.team?this.owner.team.camp:s.TeamCamp.Neutral},e.prototype.getNearestTarget=function(t){var e=this;void 0===t&&(t=this.range);var n=this.getTargetListByRange(t);return n.sort(function(t,n){return e.gameObject.position.copy().subtract(t.gameObject.position).squaredLength()-e.gameObject.position.copy().subtract(n.gameObject.position).squaredLength()}),n.length>0?n[0]:null},e.prototype.getWeakestTarget=function(t){return null!=t&&t.length>0?t.sort(function(t,e){return t.getHpRate()-e.getHpRate()})[0]:null},e.prototype.hasTargetInRange=function(t){if(void 0===t&&(t=this.range),null!=this.owner&&null!=this.owner.team&&null!=this.owner.team.teamManager)for(var e=0;e<this.owner.team.teamManager.teamList.length;++e){var n=this.owner.team.teamManager.teamList[e];if(this.owner.team.isAgainstTeam(n.camp))for(var o=0,i=n.members;o<i.length;o++){var a=i[o];if(this.range>=r.vec2.distance(this.gameObject.position,a.gameObject.position))return!0}}return!1},e.prototype.getTargetListByRange=function(t){return void 0===t&&(t=this.range),null!=this.owner&&null!=this.owner.team&&null!=this.owner.team.teamManager?this.owner.team.teamManager.getTargetListByRange(this.gameObject.position,this.range,this.owner.team.camp):[]},e.prototype.canUseSkill=function(){return this.hasTargetInRange()},e.prototype.onUseSkill=function(){},e.prototype.update=function(t){null!=this.owner&&null!=this.owner.team&&(t+=this.owner.team.skillCooldownTimescale*t),this.cooldown.update(t).isDone()&&this.canUseSkill()&&(this.cooldown.reset(),this.onUseSkill())},e}(a.Component);e.Skill=c},function(t,e){var n=function(){function t(t){void 0===t&&(t=0),this.interval=0,this.elasped=0,this.interval=t}return t.prototype.almost=function(){this.elasped=this.interval},t.prototype.reset=function(){this.elasped=0},t.prototype.progress=function(){return this.interval>0?this.elasped/this.interval:0},t.prototype.isEmpty=function(){return 0===this.elasped},t.prototype.isDone=function(){return this.elasped>=this.interval},t.prototype.update=function(t){return void 0===t&&(t=0),this.elasped+=t,this},t.prototype.isDoneByUpdate=function(t){return void 0===t&&(t=0),this.elasped+=t,this.elasped>=this.interval&&(this.elasped=0,!0)},t}();e.Timer=n},function(t,e,n){var o,i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(13),a=n(8),s=n(11),c=n(4),l=n(14),u=n(6),p=n(15);!function(t){t[t.Blue=0]="Blue",t[t.Red=1]="Red",t[t.Neutral=2]="Neutral"}(o=e.TeamCamp||(e.TeamCamp={}));var h=function(t){function e(){var e=t.apply(this,arguments)||this;return e.members=[],e.speed=200,e.spacing=50,e.camp=o.Neutral,e.teamManager=null,e.coin=0,e.skillCooldownTimescale=0,e.lastFormation=[],e}return i(e,t),e.prototype.isAgainstTeam=function(t){return this.camp!==t},e.prototype.isSelfTeam=function(t){return this.camp===t},e.prototype.getLeader=function(){return this.members.length>0?this.members[0]:null},e.prototype.getDirection=function(){return null!=this.getLeader()?this.getLeader().direction:p.Directions.Up},e.prototype.setMemberList=function(t){if(!(null==t||t.length<=0)){this.lastFormation=[],this.members=[];for(var e=0;e<t.length;++e)this.addMember(t[e])}},e.prototype.addMember=function(t){if(this.members.length>0){var e=this.members[this.members.length-1];t.setDirection(e.direction),t.gameObject.position=e.getFollowPosition(this.spacing)}this.members.push(t),t.team=this,this.trigger("OnTeamAddMember",t)},e.prototype.removeMember=function(t,e){if(void 0===e&&(e=o.Neutral),t===this.getLeader()){this.onLeaderRemoved(e);for(var n=0;n<this.members.length;++n)this.trigger("OnTeamRemoveMember",this.members[n],e),this.members[n].gameObject.removeFromParent();this.members=[],null!=this.teamManager&&this.teamManager.removeTeam(this)}else for(var i=1;i<this.members.length;++i)if(this.members[i]===t){if(i+1<this.members.length){var r=this.members[i+1];r.path=r.path.concat(t.path)}this.members.splice(i,1),this.trigger("OnTeamRemoveMember",t,e),t.gameObject.removeFromParent();break}},e.prototype.onLeaderRemoved=function(t){},e.prototype.changeDirection=function(t){null!=this.getLeader()&&(this.getLeader().setDirection(t),this.members.length>1&&this.members[1].addTurnPoint({direction:t,position:this.getLeader().gameObject.position.copy()}))},e.prototype.limitLeaderMoveRange=function(){this.gameObject.position.x<0?(this.gameObject.position.x=0,this.changeDirection(p.Directions.Right)):this.gameObject.position.x>l.Map.MaxSize.x?(this.gameObject.position.x=l.Map.MaxSize.x,this.changeDirection(p.Directions.Left)):this.gameObject.position.y<0?(this.gameObject.position.y=0,this.changeDirection(p.Directions.Up)):this.gameObject.position.y>l.Map.MaxSize.y&&(this.gameObject.position.y=l.Map.MaxSize.y,this.changeDirection(p.Directions.Down))},e.prototype.moveLeader=function(t){this.getLeader().moveDirection(t),this.limitLeaderMoveRange()},e.prototype.moveMember=function(t,e,n,o){if(null!=t)if(t.hasTurningPoint()){if(t.moveToTurningPoint(o)){var i=t.path.shift();null!=n&&n.addTurnPoint(i)}}else t.followMove(o,this.spacing,e)},e.prototype.moveMembers=function(t){if(null!=this.getLeader()){this.moveLeader(t*this.speed);for(var e=1;e<this.members.length;++e)this.moveMember(this.members[e],this.members[e-1],e+1<this.members.length?this.members[e+1]:null,t*this.speed)}},e.prototype.moveMembersWithoutFollow=function(t){for(var e=0,n=this.members;e<n.length;e++){var o=n[e];o.moveDirection(t*this.speed)}},e.prototype.getFormationXY=function(){for(var t=[],e=0,n=this.members;e<n.length;e++){var o=n[e];t.push(o.gameObject.position.xy)}return t},e.prototype.getLeaderPosition=function(){return null!=this.getLeader()?this.getLeader().gameObject.position:c.v2()},e.prototype.recordFormation=function(){this.lastFormation=[];for(var t=0,e=this.members;t<e.length;t++){var n=e[t];this.lastFormation.push(n.gameObject.position.copy())}},e.prototype.loadFormation=function(){
for(var t=0;t<this.lastFormation.length;++t)this.members.length>t&&(this.members[t].gameObject.position=this.lastFormation[t])},e}(u.Component);e.Team=h;var m=function(t){function e(){return t.apply(this,arguments)||this}return i(e,t),e.prototype.onEnable=function(){this.on("OnTriggerDirection",this)},e.prototype.onDisable=function(){this.off("OnTriggerDirection",this)},e.prototype.onLeaderRemoved=function(){this.trigger("OnPlayerTeamRemoved",this)},e.prototype.OnTriggerDirection=function(t,e){void 0===e&&(e=o.Blue),this.camp===e&&null!=this.getLeader()&&this.changeDirection(t)},e.prototype.update=function(t){this.moveMembers(t)},e.prototype.getRandomDirection=function(){return this.gameObject.world.choice(d[this.getLeader().direction])},e}(h);e.PlayerTeam=m;var d={};d[p.Directions.Up]=d[p.Directions.Down]=[p.Directions.Left,p.Directions.Right],d[p.Directions.Left]=d[p.Directions.Right]=[p.Directions.Up,p.Directions.Down];var g=function(t){function e(){var e=t.apply(this,arguments)||this;return e.nextChangeTime=5,e}return i(e,t),e.prototype.update=function(t){this.moveMembers(t),this.nextChangeTime-=t,this.nextChangeTime<=0&&(this.nextChangeTime=this.getChangeTime(),this.changeDirection(this.gameObject.world.choice(d[this.getLeader().direction])))},e.prototype.getChangeTime=function(){return this.gameObject.world.nextRange(2,6)},e}(h);e.AITeam=g;var f=function(t){function e(){return t.apply(this,arguments)||this}return i(e,t),e.prototype.resetByLastFrameFormationXY=function(){},e.prototype.onLeaderRemoved=function(t){this.trigger("OnTowerTeamRemoved",this)},e.prototype.moveMembersWithoutFollow=function(t){},e}(h);e.TowerTeam=f;var y=function(t){function e(){var e=t.apply(this,arguments)||this;return e.killCamp=o.Neutral,e}return i(e,t),e.prototype.resetByLastFrameFormationXY=function(){},e.prototype.onLeaderRemoved=function(t){this.killCamp=t,this.trigger("OnBossTeamRemoved",this)},e.prototype.moveMembersWithoutFollow=function(t){},e}(h);e.BossTeam=y;var v=function(t){function e(){var e=t.apply(this,arguments)||this;return e.speed=0,e.createTimer=new s.Timer(10),e.createHeroIdList=[],e.curLevel=1,e.directionList=[p.Directions.Up,p.Directions.Down],e.curDirectionIndex=0,e.isRandomMove=!1,e.playerTeam=null,e.playerHeroIdList=[],e.rebornTimer=new s.Timer(5),e.supplyRange=50,e.supplyTimer=new s.Timer(20),e}return i(e,t),e.prototype.resetByLastFrameFormationXY=function(){},e.prototype.onEnable=function(){this.on("OnPlayerTeamRemoved",this),this.on("OnTowerTeamRemoved",this),this.on("OnBossTeamRemoved",this)},e.prototype.onDisable=function(){this.off("OnPlayerTeamRemoved",this),this.off("OnTowerTeamRemoved",this),this.off("OnBossTeamRemoved",this)},e.prototype.OnPlayerTeamRemoved=function(t){this.playerTeam===t&&(this.playerTeam=null,this.rebornTimer.reset(),this.trigger("OnPlayerTeamReborn",this.rebornTimer.interval))},e.prototype.OnTowerTeamRemoved=function(t){if(null!=t&&t.camp===this.camp){var e=this.playerTeam.gameObject.addComponent(r.SkillCooldownChange);e.team=this.playerTeam,e.useTimescale(1),e.removeTimer.interval=10}},e.prototype.OnBossTeamRemoved=function(t){if(null!=t&&t.killCamp===this.camp){var e=this.playerTeam.gameObject.addComponent(r.SkillCooldownChange);e.team=this.playerTeam,e.useTimescale(1),e.removeTimer.interval=20;for(var n=0,o=this.playerTeam.members;n<o.length;n++){var i=o[n];this.trigger("OnSkillCooldownChangeAdd",i)}}},e.prototype.onLeaderRemoved=function(){this.trigger("OnBaseTeamRemoved",this)},e.prototype.initMain=function(t){if(null!=this.teamManager){var e=a.ConfigToComponent.createHero(t,this.gameObject);return e.direction=p.Directions.Down,this.setMemberList([e]),this.teamManager.teamList.push(this),e}return null},e.prototype.initPlayerTeam=function(t){return this.playerHeroIdList=t,this.createPlayerTeam()},e.prototype.initTowerTeam=function(t,e){if(null!=this.teamManager){var n=a.ConfigToComponent.createHero(t,this.gameObject.world.createGameObject());n.gameObject.position.xy=e.xy,n.direction=p.Directions.Down;var o=n.gameObject.addComponent(f);return o.camp=this.camp,o.teamManager=this.teamManager,o.setMemberList([n]),this.teamManager.teamList.push(o),o}return null},e.prototype.createPlayerTeam=function(){if(!(this.playerHeroIdList.length<=0||null==this.teamManager)){var t=a.ConfigToComponent.createHeroList(this.playerHeroIdList,this.gameObject.world,this.camp);if(t[0].direction=this.camp===o.Blue?p.Directions.Up:p.Directions.Down,this.playerTeam=this.teamManager.createPlayerTeam(t,this.gameObject.position,this.camp),this.playerTeam.camp=this.camp,this.isRandomMove){var e=this.gameObject.addComponent(b);e.playerTeam=this.playerTeam}return this.playerTeam}},e.prototype.createTeam=function(){if(!(null==this.teamManager||this.createHeroIdList.length<=0)){for(var t=[],e=0,n=this.createHeroIdList;e<n.length;e++){var o=n[e],i=this.gameObject.world.createGameObject();t.push(a.ConfigToComponent.createHero(o,i,this.curLevel))}return++this.curLevel,this.changeTeamDirection(t),this.teamManager.createAITeam(t,this.gameObject.position,this.camp)}},e.prototype.changeTeamDirection=function(t){t.length>0&&(0<=this.curDirectionIndex&&this.curDirectionIndex<this.directionList.length&&(t[0].direction=this.directionList[this.curDirectionIndex]),this.curDirectionIndex=this.curDirectionIndex<this.directionList.length-1?this.curDirectionIndex+1:0)},e.prototype.isPlayerTeamInSupplyRange=function(){return null!=this.playerTeam&&null!=this.playerTeam.getLeader()&&c.vec2.distance(this.gameObject.position,this.playerTeam.getLeader().gameObject.position)<=this.supplyRange},e.prototype.isPlayerTeamNeedSupply=function(){if(this.playerTeam.members.length<this.playerHeroIdList.length)return!0;for(var t=0,e=this.playerTeam.members;t<e.length;t++){var n=e[t];if(!n.isFullHp())return!0}return!1},e.prototype.moveMembersWithoutFollow=function(t){},e.prototype.update=function(t){if(this.createTimer.update(t).isDone()&&(this.createTimer.reset(),this.createTeam()),null==this.playerTeam&&this.rebornTimer.update(t).isDone()&&(this.rebornTimer.reset(),this.createPlayerTeam()),this.supplyTimer.update(t).isDone()&&this.isPlayerTeamInSupplyRange()&&this.isPlayerTeamNeedSupply()){this.supplyTimer.reset();for(var e=[],n=0,o=this.playerTeam.members;n<o.length;n++){var i=o[n];e.push(i.id),i.heal(i.maxHp)}for(var r=[],s=0,c=this.playerHeroIdList;s<c.length;s++){var l=c[s];r.push(l)}for(var u=0,p=e;u<p.length;u++){var h=p[u];for(var m in r)if(r[m]===h){r[m]=null;break}}for(var d=0,g=r;d<g.length;d++){var f=g[d];null!=f&&this.playerTeam.addMember(a.ConfigToComponent.createHero(f,this.gameObject.world.createGameObject()))}this.trigger("OnPlayerTeamSupply",this)}},e}(h);e.BaseTeam=v;var b=function(t){function e(){var e=t.apply(this,arguments)||this;return e.nextChangeTime=5,e}return i(e,t),e.prototype.update=function(t){this.nextChangeTime-=t,this.nextChangeTime<=0&&(this.nextChangeTime=this.getChangeTime(),null!=this.playerTeam&&this.playerTeam.changeDirection(this.playerTeam.getRandomDirection()))},e.prototype.getChangeTime=function(){return this.gameObject.world.nextRange(2,6)},e.prototype.onEnable=function(){this.on("OnPlayerTeamRemoved",this)},e.prototype.onDisable=function(){this.off("OnPlayerTeamRemoved",this)},e.prototype.OnPlayerTeamRemoved=function(t){this.playerTeam===t&&this.gameObject.removeComponent(this)},e}(u.Component);e.RandomMove=b;var C=function(t){function e(){var e=t.apply(this,arguments)||this;return e.timer=new s.Timer,e.eventName="",e}return i(e,t),e.prototype.update=function(t){this.timer.update(t).isDone()&&(this.trigger(this.eventName),this.gameObject.removeFromParent())},e}(u.Component);e.Countdown=C},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(11),r=n(6),a=function(t){function e(){var e=t.apply(this,arguments)||this;return e.timescale=0,e.removeTimer=new i.Timer(1),e.team=null,e}return o(e,t),e.prototype.onDisable=function(){this.useTimescale(0)},e.prototype.useTimescale=function(t){null!=this.team&&(this.team.skillCooldownTimescale-=this.timescale,this.timescale=t,this.team.skillCooldownTimescale+=t)},e.prototype.update=function(t){if(this.removeTimer.update(t).isDone()){for(var e=0,n=this.team.members;e<n.length;e++){var o=n[e];this.trigger("OnSkillCooldownChangeRemove",o)}this.gameObject.removeComponent(this)}},e}(r.Component);e.SkillCooldownChange=a},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(4),r=n(6),a=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e.getRandomPosition=function(t,n){return void 0===t&&(t=0),void 0===n&&(n=0),i.v2(e.MaxSize.x*t,e.MaxSize.y*n)},e.getCenter=function(){return i.v2(.5*e.MaxSize.x,.5*e.MaxSize.y)},e}(r.Component);a.MaxSize=i.v2(1200,1200),e.Map=a},function(t,e,n){var o,i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(6),a=n(4);!function(t){t[t.Up=0]="Up",t[t.Down=1]="Down",t[t.Left=2]="Left",t[t.Right=3]="Right"}(o=e.Directions||(e.Directions={}));var s={};s[o.Up]=a.v2(0,1),s[o.Down]=a.v2(0,-1),s[o.Left]=a.v2(-1,0),s[o.Right]=a.v2(1,0);var c=function(t){function e(){var e=t.apply(this,arguments)||this;return e.id="1",e.hp=1,e.maxHp=1,e.direction=o.Up,e.path=[],e.team=null,e}return i(e,t),e.prototype.getHpRate=function(){return 0===this.maxHp?0:this.hp/this.maxHp},e.prototype.isFullHp=function(){return this.hp>=this.maxHp},e.prototype.moveDirection=function(t,e){void 0===e&&(e=this.direction),this.gameObject.position.add(this.getDirectionVector(t,e))},e.prototype.getDirectionVector=function(t,e){return void 0===e&&(e=this.direction),a.v2(t,t).multiply(s[e])},e.prototype.getFollowPosition=function(t){var e=this.getDirectionVector(t).negate();return e.add(this.gameObject.position),e},e.prototype.hasTurningPoint=function(){return this.path.length>0},e.prototype.addTurnPoint=function(t){this.path.push(t)},e.prototype.followMove=function(t,e,n){if(null!=n){var o=n.gameObject.position.copy().subtract(this.gameObject.position),i=o.length();i<=e||(i<e+2*t?this.gameObject.position.add(o.normalize().scale(i-e)):this.gameObject.position.add(o.normalize().scale(2*t)))}},e.prototype.moveToTurningPoint=function(t){var e=this.path[0],n=e.position.copy().subtract(this.gameObject.position),o=n.length();return o>t?(this.gameObject.position.add(n.normalize().scale(t)),!1):(this.gameObject.position.xy=e.position.xy,this.setDirection(e.direction),!0)},e.prototype.setDirection=function(t){this.direction=t,this.trigger("OnHeroChangeDirection",this)},e.prototype.hurt=function(t,e){this.hp=this.hp>t?this.hp-t:0,this.trigger("OnHeroHurt",this,t),this.hp<=0&&(null!=this.team&&this.team.removeMember(this,e),this.trigger("OnHeroDead",this,e))},e.prototype.heal=function(t){this.hp<this.maxHp&&(this.hp=this.hp+t<this.maxHp?this.hp+t:this.maxHp),this.trigger("OnHeroHeal",this,t)},e}(r.Component);e.Hero=c},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(11),r=n(10),a=n(6),s=function(t){function e(){var e=t.apply(this,arguments)||this;return e.damage=0,e.readyTime=1,e}return o(e,t),e.prototype.getTarget=function(){return this.getWeakestTarget(this.getTargetListByRange())},e.prototype.onUseSkill=function(){var t=this.gameObject.addComponent(c);t.damageTimer=new i.Timer(this.readyTime),t.snipe=this,t.target=this.getTarget(),this.trigger("OnSnipeBegin",t)},e}(r.Skill);e.Snipe=s;var c=function(t){function e(){var e=t.apply(this,arguments)||this;return e.damageTimer=null,e.snipe=null,e.target=null,e}return o(e,t),e.prototype.onEnable=function(){this.on("OnTeamRemoveMember",this)},e.prototype.onDisable=function(){this.off("OnTeamRemoveMember",this)},e.prototype.OnTeamRemoveMember=function(t){this.target===t&&(this.target=null)},e.prototype.update=function(t){null!=this.damageTimer&&this.damageTimer.update(t).isDone()&&(null!=this.target&&null!=this.snipe&&(this.target.hurt(this.snipe.damage,this.snipe.getCamp()),this.trigger("OnSnipeShoot",this)),this.gameObject.removeComponent(this))},e}(a.Component);e.SnipeSight=c},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(10),r=n(15),a=function(t){function e(){var e=t.apply(this,arguments)||this;return e.damage=0,e.width=0,e}return o(e,t),e.prototype.isInRectangle=function(t,e){var n=t.copy().subtract(this.gameObject.position);switch(e){case r.Directions.Up:return-this.width<=n.x&&n.x<=this.width&&0<=n.y&&n.y<=this.range;case r.Directions.Down:return-this.width<=n.x&&n.x<=this.width&&-this.range<=n.y&&n.y<=0;case r.Directions.Left:return-this.range<=n.x&&n.x<=0&&-this.width<=n.y&&n.y<=this.width;case r.Directions.Right:return 0<=n.x&&n.x<=this.range&&-this.width<=n.y&&n.y<=this.width}return!1},e.prototype.getTargetList=function(){var t=this;return null==this.getTeamManager()?[]:this.getTeamManager().getTargetListByCamp(this.owner.team.camp).filter(function(e,n,o){return t.isInRectangle(e.gameObject.position,t.owner.direction)})},e.prototype.hasTargetInRange=function(t){if(void 0===t&&(t=this.range),null!=this.owner&&null!=this.owner.team&&null!=this.owner.team.teamManager)for(var e=0;e<this.owner.team.teamManager.teamList.length;++e){var n=this.owner.team.teamManager.teamList[e];if(this.owner.team.isAgainstTeam(n.camp))for(var o=0,i=n.members;o<i.length;o++){var r=i[o];if(this.isInRectangle(r.gameObject.position,this.owner.direction))return!0}}return!1},e.prototype.onUseSkill=function(){for(var t=0,e=this.getTargetList();t<e.length;t++){var n=e[t];n.hurt(this.damage,this.getCamp())}this.trigger("OnRectangleAOECreate",this)},e}(i.Skill);e.RectangleAOE=a},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(10),r=n(15),a=function(t){function e(){var e=t.apply(this,arguments)||this;return e.damage=0,e}return o(e,t),e.prototype.isHalfCycleDirection=function(t,e){switch(e){case r.Directions.Up:return t.y>=this.gameObject.position.y;case r.Directions.Down:return t.y<=this.gameObject.position.y;case r.Directions.Left:return t.x<=this.gameObject.position.x;case r.Directions.Right:return t.x>=this.gameObject.position.x}return!1},e.prototype.isInHalfCycle=function(t,e){return this.range>=this.gameObject.position.copy().subtract(t).length()&&this.isHalfCycleDirection(t,e)},e.prototype.getTargetList=function(){var t=this;if(null==this.owner)return[];var e=this.getTargetListByRange();return e.filter(function(e,n,o){return t.isHalfCycleDirection(e.gameObject.position,t.owner.direction)})},e.prototype.hasTargetInRange=function(t){if(void 0===t&&(t=this.range),null!=this.owner&&null!=this.owner.team&&null!=this.owner.team.teamManager)for(var e=0;e<this.owner.team.teamManager.teamList.length;++e){var n=this.owner.team.teamManager.teamList[e];if(this.owner.team.isAgainstTeam(n.camp))for(var o=0,i=n.members;o<i.length;o++){var r=i[o];if(this.isInHalfCycle(r.gameObject.position,this.owner.direction))return!0}}return!1},e.prototype.onUseSkill=function(){for(var t=0,e=this.getTargetList();t<e.length;t++){var n=e[t];n.hurt(this.damage,this.getCamp())}this.trigger("OnHalfCycleAOECreate",this)},e}(i.Skill);e.HalfCycleAOE=a},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(20),r=n(10),a=function(t){function e(){var e=t.apply(this,arguments)||this;return e.damage=0,e.speed=0,e.bombRange=0,e}return o(e,t),e.prototype.onUseSkill=function(){var t=this.getNearestTarget();if(null!=t){var e=this.gameObject.world.createGameObject().addComponent(i.Bomb);e.gameObject.position.xy=this.gameObject.position.xy,e.damage=this.damage,e.speed=this.speed,e.targetPosition.xy=t.gameObject.position.xy,e.range=this.bombRange,null!=this.owner&&null!=this.owner.team&&(e.camp=this.owner.team.camp,e.teamManager=this.owner.team.teamManager),this.trigger("OnBombCreated",e)}},e}(r.Skill);e.BombEmitter=a},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(4),r=n(6),a=n(12),s=function(t){function e(){var e=t.apply(this,arguments)||this;return e.targetPosition=i.v2(0,0),e.damage=0,e.speed=0,e.range=0,e.camp=a.TeamCamp.Neutral,e.teamManager=null,e}return o(e,t),e.prototype.moveByDistance=function(t,e){var n=t.copy().subtract(this.gameObject.position);n.normalize().scale(e),this.gameObject.position.add(n)},e.prototype.getTargetDistance=function(){var t=this.gameObject.position.copy().subtract(this.targetPosition);return t.length()},e.prototype.getTargetList=function(){return null!=this.teamManager?this.teamManager.getTargetListByRange(this.gameObject.position,this.range,this.camp):[]},e.prototype.update=function(t){var e=t*this.speed;if(e<this.getTargetDistance())this.moveByDistance(this.targetPosition,e);else{if(this.gameObject.position.xy=this.targetPosition.xy,null!=this.teamManager)for(var n=0,o=this.getTargetList();n<o.length;n++){var i=o[n];i.hurt(this.damage,this.camp)}this.trigger("OnBombExplosion",this),this.gameObject.removeFromParent()}},e}(r.Component);e.Bomb=s},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(10),r=function(t){function e(){var e=t.apply(this,arguments)||this;return e.damage=0,e}return o(e,t),e.prototype.onUseSkill=function(){for(var t=0,e=this.getTargetListByRange();t<e.length;t++){var n=e[t];n.hurt(this.damage,this.getCamp())}this.trigger("OnCycleAOECreate",this)},e}(i.Skill);e.CycleAOE=r},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(14),r=n(10),a=n(12),s=n(4),c=n(6),l=function(t){function e(){var e=t.apply(this,arguments)||this;return e.damage=0,e.speed=0,e.bulletRange=0,e}return o(e,t),e.prototype.onUseSkill=function(){var t=this.getNearestTarget();if(null!=t){var e=this.gameObject.world.createGameObject().addComponent(u);e.gameObject.position.xy=this.gameObject.position.xy,e.damage=this.damage,e.teamManager=this.getTeamManager(),e.range=this.bulletRange,null!=this.owner&&null!=this.owner.team&&(e.camp=this.owner.team.camp),e.speedVector=s.vec2.direction(t.gameObject.position,this.gameObject.position).scale(this.speed),0===e.speedVector.x&&0===e.speedVector.y&&(e.speedVector.x=this.speed),this.trigger("OnBulletCreated",e)}},e}(r.Skill);e.BulletEmitter=l;var u=function(t){function e(){var e=t.apply(this,arguments)||this;return e.teamManager=null,e.damage=0,e.range=0,e.camp=a.TeamCamp.Neutral,e.speedVector=s.v2(0,0),e}return o(e,t),e.prototype.getTarget=function(){return null!=this.teamManager?this.teamManager.getAnyTarget(this.gameObject.position,this.range,this.camp):null},e.prototype.update=function(t){if(s.vec2.contains(i.Map.MaxSize,this.gameObject.position)){var e=this.getTarget();null!=e?(e.hurt(this.damage,this.camp),this.trigger("OnBulletFinish",this),this.gameObject.removeFromParent()):this.gameObject.position.add(this.speedVector.copy().scale(t))}else this.trigger("OnBulletFinish",this),this.gameObject.removeFromParent()},e}(c.Component);e.Bullet=u},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(10),r=n(4),a=function(t){function e(){var e=t.apply(this,arguments)||this;return e.health=0,e}return o(e,t),e.prototype.getTargetList=function(){for(var t=[],e=0,n=this.getTeamManager().getSelfTargetListByCamp(this.owner.team.camp);e<n.length;e++){var o=n[e];!o.isFullHp()&&this.range>=r.vec2.distance(this.gameObject.position,o.gameObject.position)&&t.push(o)}return t},e.prototype.getTarget=function(){return null==this.getTeamManager()?null:this.getWeakestTarget(this.getTargetList())},e.prototype.hasTargetInRange=function(){if(null==this.getTeamManager())return!1;for(var t=0,e=this.getTeamManager().getSelfTargetListByCamp(this.owner.team.camp);t<e.length;t++){var n=e[t];if(!n.isFullHp()&&this.range>=r.vec2.distance(this.gameObject.position,n.gameObject.position))return!0}return!1},e.prototype.onUseSkill=function(){var t=this.getTarget();null!=t&&t.heal(this.health)},e}(i.Skill);e.Heal=a},function(t,e,n){var o=function(){function t(t){this.dic={},this.list=t;for(var e=0,n=t;e<n.length;e++){var o=n[e];this.dic[o.id]=o}}return t.prototype.find=function(t){return this.dic[t]},t}();e.CsvDictionary=o;var i=n(25),r=n(26),a=n(27),s=n(28),c=n(29),l=n(30),u=n(31),p=n(32),h=n(33),m=function(){function t(){this.heroDic=new o(i.HeroCsvList),this.bombEmitterDic=new o(r.BombEmitterCsvList),this.bulletEmitterDic=new o(a.BulletEmitterCsvList),this.cycleAOEDic=new o(s.CycleAOECsvList),this.halfCycleAOEDic=new o(c.HalfCycleAOECsvList),this.healDic=new o(l.HealCsvList),this.rectangleAOEDic=new o(u.RectangleAOECsvList),this.snipeDic=new o(p.SnipeCsvList),this.tracerBulletEmitterDic=new o(h.TracerBulletEmitterCsvList)}return t}();e.ConfigLoader=m,e.Config=new m},function(t,e){e.HeroCsvList=[{id:1,name:"典韦",hp:200,image:"Unit_mov_139-1",skill:"CycleAOE",skillId:1,face:"Face_24-1",detail:"号称古之恶来，技能为圆形范围攻击"},{id:2,name:"于禁",hp:100,image:"Unit_mov_22-1",skill:"BulletEmitter",skillId:1,face:"Face_11-1",detail:"五子良将之一，技能为单发远程攻击"},{id:3,name:"貂蝉",hp:100,image:"Unit_mov_118-1",skill:"Heal",skillId:1,face:"Face_25-1",detail:"四大美女之一，可以治疗范围内最虚弱的我方英雄"},{id:4,name:"许褚",hp:100,image:"Unit_mov_142-1",skill:"HalfCycleAOE",skillId:1,face:"Face_23-1",detail:"曹操大将，技能为扇形aoe攻击"},{id:5,name:"司马懿",hp:100,image:"Unit_mov_121-1",skill:"BombEmitter",skillId:1,face:"Face_32-1",detail:"晋国太祖，攻击时扔出炸弹"},{id:6,name:"郭嘉",hp:100,image:"Unit_mov_82-1",skill:"TracerBulletEmitter",skillId:1,face:"Face_28-1",detail:"曹操最重要的谋士，攻击为远程单体攻击"},{id:7,name:"夏侯惇",hp:100,image:"Unit_mov_112-1",skill:"RectangleAOE",skillId:1,face:"Face_9-1",detail:"独眼将军，向前发出aoe攻击"},{id:100,name:"步兵红",hp:200,image:"Unit_mov_1-1",skill:"HalfCycleAOE",skillId:100,face:"",detail:""},{id:101,name:"骑兵红",hp:100,image:"Unit_mov_10-1",skill:"RectangleAOE",skillId:100,face:"",detail:""},{id:102,name:"弓兵红",hp:100,image:"Unit_mov_19-1",skill:"BulletEmitter",skillId:100,face:"",detail:""},{id:103,name:"步兵蓝",hp:200,image:"Unit_mov_3-1",skill:"HalfCycleAOE",skillId:100,face:"",detail:""},{id:104,name:"骑兵蓝",hp:100,image:"Unit_mov_12-1",skill:"RectangleAOE",skillId:100,face:"",detail:""},{id:105,name:"弓兵蓝",hp:100,image:"Unit_mov_21-1",skill:"BulletEmitter",skillId:100,face:"",detail:""},{id:106,name:"炮兵红",hp:500,image:"Unit_mov_55-1",skill:"TracerBulletEmitter",skillId:1,face:"",detail:""},{id:107,name:"炮兵蓝",hp:500,image:"Unit_mov_57-1",skill:"TracerBulletEmitter",skillId:1,face:"",detail:""},{id:108,name:"虎兵",hp:200,image:"Unit_mov_92-1",skill:"TracerBulletEmitter",skillId:1,face:"",detail:""},{id:200,name:"曹操",hp:500,image:"Unit_mov_109-1",skill:"TracerBulletEmitter",skillId:1,face:"Face_1-1",detail:"魏国太祖，单体远程攻击"},{id:201,name:"刘备",hp:500,image:"Unit_mov_145-1",skill:"TracerBulletEmitter",skillId:1,face:"Face_40-1",detail:"蜀国太祖，单体远程攻击"}]},function(t,e){e.BombEmitterCsvList=[{id:1,range:200,cooldown:2,damage:10,speed:400,bombRange:50}]},function(t,e){e.BulletEmitterCsvList=[{id:1,range:200,cooldown:2,damage:20,speed:400,bulletRange:20},{id:100,range:200,cooldown:2,damage:10,speed:400,bulletRange:20}]},function(t,e){e.CycleAOECsvList=[{id:1,range:200,cooldown:2,damage:30}]},function(t,e){e.HalfCycleAOECsvList=[{id:1,range:200,cooldown:2,damage:30},{id:100,range:100,cooldown:5,damage:10}]},function(t,e){e.HealCsvList=[{id:1,range:200,cooldown:5,health:20}]},function(t,e){e.RectangleAOECsvList=[{id:1,range:200,cooldown:2,damage:30,width:50},{id:100,range:100,cooldown:2,damage:10,width:30}]},function(t,e){e.SnipeCsvList=[{id:1,range:400,cooldown:2,damage:50,readyTime:1}]},function(t,e){e.TracerBulletEmitterCsvList=[{id:1,range:200,cooldown:2,damage:20,speed:400}]},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(4),r=n(12),a=n(6),s=function(t){function e(){var e=t.apply(this,arguments)||this;return e.teamList=[],e}return o(e,t),e.prototype.hasAnyFullTeam=function(t){for(var e=7,n=0,o=this.getSelfTeamList(t);n<o.length;n++){var i=o[n];if(i.members.length>=e)return!0}return!1},e.prototype.getAgainstTeamList=function(t){for(var e=[],n=0,o=this.teamList;n<o.length;n++){var i=o[n];i.isAgainstTeam(t)&&e.push(i)}return e},e.prototype.getSelfTeamList=function(t){for(var e=[],n=0,o=this.teamList;n<o.length;n++){var i=o[n];i.isSelfTeam(t)&&e.push(i)}return e},e.prototype.getTeamList=function(t){for(var e=[],n=0,o=this.teamList;n<o.length;n++){var i=o[n];i.camp===t&&e.push(i)}return e},e.prototype.getAnyTarget=function(t,e,n){for(var o=0,r=this.getAgainstTeamList(n);o<r.length;o++)for(var a=r[o],s=0,c=a.members;s<c.length;s++){var l=c[s];if(i.vec2.distance(t,l.gameObject.position)<=e)return l}return null},e.prototype.getAnySelfTarget=function(t,e,n){for(var o=0,r=this.getSelfTeamList(n);o<r.length;o++)for(var a=r[o],s=0,c=a.members;s<c.length;s++){var l=c[s];if(i.vec2.distance(t,l.gameObject.position)<=e)return l}return null},e.prototype.getTargetListByRange=function(t,e,n){for(var o=[],r=0;r<this.teamList.length;++r){var a=this.teamList[r];if(a.isAgainstTeam(n))for(var s=0,c=a.members;s<c.length;s++){var l=c[s];e>=i.vec2.distance(t,l.gameObject.position)&&o.push(l)}}return o},e.prototype.getTargetListByCamp=function(t){for(var e=[],n=0;n<this.teamList.length;++n){var o=this.teamList[n];o.isAgainstTeam(t)&&(e=e.concat(o.members))}return e},e.prototype.getSelfTargetListByCamp=function(t){for(var e=[],n=0;n<this.teamList.length;++n){var o=this.teamList[n];t===o.camp&&(e=e.concat(o.members))}return e},e.prototype.createPlayerTeam=function(t,e,n){if(void 0===t&&(t=[]),void 0===e&&(e=i.v2()),void 0===n&&(n=r.TeamCamp.Blue),t.length>0){t[0].gameObject.position.xy=e.xy;var o=t[0].gameObject.addComponent(r.PlayerTeam);return o.teamManager=this,o.camp=n,o.setMemberList(t),this.teamList.push(o),this.trigger("OnPlayerTeamCreated",o),o}return null},e.prototype.createAITeam=function(t,e,n){if(void 0===t&&(t=[]),void 0===e&&(e=i.v2()),void 0===n&&(n=r.TeamCamp.Neutral),t.length>0){t[0].gameObject.position.xy=e.xy;var o=t[0].gameObject.addComponent(r.AITeam);return o.teamManager=this,o.camp=n,o.setMemberList(t),this.teamList.push(o),o}return null},e.prototype.removeTeam=function(t){for(var e=[],n=0;n<this.teamList.length;++n)t!==this.teamList[n]?e.push(this.teamList[n]):this.trigger("OnTeamRemoved",t);this.teamList=e},e}(a.Component);e.TeamManager=s},function(t,e){var n=function(){function t(){this.itemList=[]}return t.prototype.add=function(t,e){this.itemList.push({rate:t,item:e})},t.prototype.remove=function(t){this.itemList=this.itemList.filter(function(e,n,o){return e.item!==t})},t.prototype.removeAll=function(){this.itemList=[]},t.prototype.has=function(t){for(var e=0,n=this.itemList;e<n.length;e++){var o=n[e];if(o.item===t)return!0}return!1},t.prototype.roll=function(t){for(var e=0,n=0,o=this.itemList;n<o.length;n++){var i=o[n];e+=i.rate}for(var r=e*t,a=0,s=this.itemList;a<s.length;a++){var i=s[a];if(r-=i.rate,r<=0)return i.item}return null},t}();e.Dice=n},function(t,e,n){var o,i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(35),a=n(6),s=n(12),c=n(37);!function(t){t[t.Coin=0]="Coin",t[t.Hero=1]="Hero"}(o=e.DropItemType||(e.DropItemType={}));var l=function(t){function e(){var e=t.apply(this,arguments)||this;return e.dropItemDice=new r.Dice,e.dropHeroIdDice=new r.Dice,e.teamManager=null,e}return i(e,t),e.prototype.onEnable=function(){this.on("OnTeamRemoveMember",this)},e.prototype.onDisable=function(){this.off("OnTeamRemoveMember",this)},e.prototype.OnTeamRemoveMember=function(t,e){if(e!==s.TeamCamp.Neutral)return this.dropItem(this.gameObject.world.nextFloat(),t.gameObject.position,e)},e.prototype.createCoinItem=function(t,e,n){var o=this.gameObject.world.createGameObject().addComponent(c.DropItemCoin);return o.gameObject.position.xy=t.xy,o.count=e,o.camp=n,o.heal=10,o.teamManager=this.teamManager,this.trigger("OnDropCoinItem",o),o},e.prototype.createHeroItem=function(t,e,n){var o=this.gameObject.world.createGameObject().addComponent(c.DropItemHero);return o.gameObject.position.xy=t.xy,o.camp=e,o.id=n,o.teamManager=this.teamManager,this.trigger("OnDropHeroItem",o),o},e.prototype.setDropRate=function(t,e){this.dropItemDice.add(t,e)},e.prototype.setHeroIdList=function(t){for(var e=0,n=t;e<n.length;e++){var o=n[e];this.dropHeroIdDice.add(1,o)}},e.prototype.dropItem=function(t,e,n){if(null!=this.teamManager&&this.teamManager.hasAnyFullTeam(n))return this.createCoinItem(e,1,n);switch(this.dropItemDice.roll(t)){case o.Coin:return this.createCoinItem(e,1,n);case o.Hero:return this.createHeroItem(e,n,this.dropHeroIdDice.roll(t)||1)}return null},e}(a.Component);e.DropItemManager=l},function(t,e,n){var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(8),r=n(6),a=n(12),s=function(t){function e(){var e=t.apply(this,arguments)||this;return e.teamManager=null,e.camp=a.TeamCamp.Neutral,e.range=50,e}return o(e,t),e.prototype.onAnyHeroGet=function(t){},e.prototype.update=function(t){if(null!=this.teamManager){var e=this.teamManager.getAnySelfTarget(this.gameObject.position,this.range,this.camp);null!=e&&(this.onAnyHeroGet(e),this.gameObject.removeFromParent())}},e}(r.Component);e.DropItem=s;var c=function(t){function e(){var e=t.apply(this,arguments)||this;return e.id=1,e}return o(e,t),e.prototype.onAnyHeroGet=function(t){if(null!=t){var e=i.ConfigToComponent.createHero(this.id,this.gameObject.world.createGameObject());t.team.addMember(e),this.trigger("OnDropItemHeroGet",this,t)}},e}(s);e.DropItemHero=c;var l=function(t){function e(){var e=t.apply(this,arguments)||this;return e.count=1,e.heal=0,e}return o(e,t),e.prototype.onAnyHeroGet=function(t){null!=t&&(null!=t.team&&(t.team.coin+=this.count),t.heal(this.heal),this.trigger("OnDropItemCoinGet",this,t))},e}(s);e.DropItemCoin=l},function(t,e,n){var o=n(15);e.Hero=o.Hero;var i=n(14);e.Map=i.Map;var r=n(20);e.Bomb=r.Bomb;var a=n(10);e.Skill=a.Skill;var s=n(34);e.TeamManager=s.TeamManager;var c=n(12);e.Team=c.Team,e.PlayerTeam=c.PlayerTeam,e.AITeam=c.AITeam,e.TowerTeam=c.TowerTeam,e.BossTeam=c.BossTeam,e.BaseTeam=c.BaseTeam,e.RandomMove=c.RandomMove,e.Countdown=c.Countdown;var l=n(21);e.CycleAOE=l.CycleAOE;var u=n(23);e.Heal=u.Heal;var p=n(17);e.RectangleAOE=p.RectangleAOE;var h=n(18);e.HalfCycleAOE=h.HalfCycleAOE;var m=n(19);e.BombEmitter=m.BombEmitter;var d=n(16);e.Snipe=d.Snipe,e.SnipeSight=d.SnipeSight;var g=n(22);e.BulletEmitter=g.BulletEmitter,e.Bullet=g.Bullet;var f=n(9);e.TracerBulletEmitter=f.TracerBulletEmitter,e.TracerBullet=f.TracerBullet;
var y=n(13);e.SkillCooldownChange=y.SkillCooldownChange;var v=n(37);e.DropItemHero=v.DropItemHero,e.DropItemCoin=v.DropItemCoin;var b=n(36);e.DropItemManager=b.DropItemManager}])}),cc._RFpop()},{}]},{},["PvpResultWin","MultiPlay","Logo","CommandPlayStageTest","Hero","StageController","SinglePlay","TracerBullet","FormationChange","gremlins","Tutorial","Bomb","KeyPressHandler","Global","TouchDragHandler","AddDirectionTrigger","Collection","DropItemCoin","Main","ToolTips","DropItemHero","sgr","HeroTest","Bullet","StageEventHandle"]);